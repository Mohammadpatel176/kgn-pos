import Ce from"preact-render-to-string";import{StaticRouter as Ie}from"react-router-dom/server.mjs";import{Link as ie,Outlet as Ae,Routes as Pe,Route as R}from"react-router-dom";import ee,{useState as y,useRef as Se,useEffect as L,useMemo as X}from"preact/compat";import{FaCogs as Te,FaUserShield as De,FaShoppingCart as ue,FaBox as de,FaFileInvoice as ke,FaWarehouse as Fe,FaBoxOpen as Re,FaCalendarAlt as Le,FaChevronLeft as Oe,FaChevronRight as Ee,FaFileExcel as Ue,FaFilePdf as Me,FaTrash as me,FaPlus as pe,FaSave as he}from"react-icons/fa";import{jsxs as t,jsx as e,Fragment as Ge}from"preact/jsx-runtime";import ge from"jspdf";import xe from"jspdf-autotable";import{toast as K,ToastContainer as je}from"react-toastify";import $ from"moment";import*as z from"xlsx";import{useState as H,useEffect as $e}from"preact/hooks";import{MagnifyingGlassIcon as W,ArrowDownTrayIcon as Ye,PencilIcon as Q,PlusCircleIcon as re,TrashIcon as ae}from"@heroicons/react/24/outline";import{X as oe,Minus as Ze,Plus as qe,Save as le}from"lucide-react";import{Tooltip as E}from"react-tooltip";import{PhoneInput as ze}from"react-international-phone";function Be(){const[l,c]=y(!1);return t("aside",{onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1),className:`bg-green-600 text-white h-full transition-all duration-300
        ${l?"w-64":"w-16"}`,children:[t("div",{className:"flex items-center gap-3 p-2 bg-green-700",children:[t(ie,{to:"/",children:[" ",e("img",{src:"/KGNNewLOGO.png",alt:"Company Logo",className:"w-10 h-10 rounded-full object-contain"})]}),l&&e("span",{className:"font-semibold whitespace-nowrap",children:"KGN Auto Parts"})]}),t("nav",{className:"mt-4 space-y-2",children:[t(B,{open:l,icon:e(Te,{}),title:"Master",children:[e(F,{to:"/master/general",children:"General Master"}),e(F,{to:"/master/other",children:"Other Masters"}),e(F,{to:"/master/categoryMaster",children:"Category Master"}),e(F,{to:"/master/itemMaster",children:"Item Master"}),e(F,{to:"/master/customerMaster",children:"Customer Master"})]}),e(_e,{open:l,icon:e(De,{}),title:"Administrator"}),t(B,{open:l,icon:e(ue,{}),title:"Sales",children:[e(F,{to:"/sales/order",children:"Sales Order"}),e(F,{to:"/sales/invoice",children:"Sales Invoice"}),e(F,{to:"/sales/open-orders",children:"Open Order List"}),e(F,{to:"/sales/pos",children:"POS"})]}),e(B,{open:l,icon:e(de,{}),title:"Purchase",children:e(F,{to:"/purchase/order",children:"Purchase Order"})}),e(B,{open:l,icon:e(de,{}),title:"Inventory",children:e(F,{to:"/inventory/update",children:"Inventory Update"})})]})]})}function _e({icon:l,title:c,open:n}){return t("div",{className:"flex items-center gap-4 px-5 py-3 hover:bg-green-700 cursor-pointer",children:[l,n&&e("span",{children:c})]})}function B({icon:l,title:c,open:n,children:i}){return t("div",{children:[t("div",{className:"flex items-center gap-4 px-5 py-3 hover:bg-green-700 cursor-pointer",children:[l,n&&e("span",{children:c})]}),n&&e("div",{className:"ml-12 text-sm text-gray-200 space-y-1",children:i})]})}function F({to:l,children:c}){return e(ie,{to:l,className:"block py-1 hover:text-black transition",children:c})}function Ve(){const[l,c]=y(!1);return t("header",{className:"h-14 bg-green-700 border-b flex justify-between items-center px-6",children:[e("h1",{className:"text-lg font-semibold text-gray-800",children:"Dashboard"}),t("div",{className:"relative",children:[e("img",{src:"https://i.pravatar.cc/40",alt:"user",onClick:()=>c(!l),className:"w-9 h-9 rounded-full cursor-pointer border"}),l&&t("div",{className:"absolute right-0 mt-2 w-40 bg-white shadow-lg rounded-md z-200",children:[e("button",{className:"block w-full px-4 py-2 text-left hover:bg-gray-100",children:"My Profile"}),e("button",{className:"block w-full px-4 py-2 text-left text-red-600 hover:bg-gray-100",children:"Logout"})]})]})]})}function Xe(){return t("div",{className:"flex h-screen bg-gray-100",children:[e(Be,{}),t("div",{className:"flex flex-col flex-1",children:[e(Ve,{}),e("main",{className:"p-4 overflow-y-auto",children:e(Ae,{})})]})]})}function He(){return t("div",{className:"space-y-6",children:[t("div",{children:[e("h1",{className:"text-2xl font-semibold text-gray-800",children:"Dashboard"}),e("p",{className:"text-sm text-gray-500",children:"Overview of your business activities"})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6",children:[e(_,{title:"Today's Sales",value:"â‚¹ 1,25,000",icon:e(ue,{}),color:"bg-green-600"}),e(_,{title:"Invoices",value:"145",icon:e(ke,{}),color:"bg-black"}),e(_,{title:"Inventory Stock",value:"8,540",icon:e(Fe,{}),color:"bg-green-700"}),e(_,{title:"Pending Orders",value:"23",icon:e(Re,{}),color:"bg-black"})]}),t("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[t("div",{className:"xl:col-span-2 bg-white rounded-lg shadow p-5",children:[e("h2",{className:"font-semibold text-gray-700 mb-4",children:"Sales Summary"}),e("div",{className:"h-56 flex items-center justify-center text-gray-400",children:"ðŸ“Š Chart placeholder (connect Recharts / Chart.js)"})]}),t("div",{className:"bg-white rounded-lg shadow p-5 space-y-4",children:[e("h2",{className:"font-semibold text-gray-700",children:"Quick Stats"}),e(V,{label:"Today's Orders",value:"32"}),e(V,{label:"Purchase Orders",value:"18"}),e(V,{label:"Low Stock Items",value:"7",danger:!0}),e(V,{label:"Returns",value:"3"})]})]}),t("div",{className:"bg-white rounded-lg shadow p-5",children:[e("h2",{className:"font-semibold text-gray-700 mb-4",children:"Recent Transactions"}),e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full text-sm",children:[e("thead",{className:"bg-gray-100 text-gray-600",children:t("tr",{children:[e("th",{className:"p-3 text-left",children:"Invoice No"}),e("th",{className:"p-3 text-left",children:"Customer"}),e("th",{className:"p-3 text-left",children:"Date"}),e("th",{className:"p-3 text-right",children:"Amount"}),e("th",{className:"p-3 text-center",children:"Status"})]})}),t("tbody",{children:[e(te,{invoice:"INV-1001",customer:"ABC Traders",date:"02 Jan 2026",amount:"â‚¹ 12,500",status:"Paid"}),e(te,{invoice:"INV-1002",customer:"XYZ Enterprises",date:"02 Jan 2026",amount:"â‚¹ 8,200",status:"Pending"}),e(te,{invoice:"INV-1003",customer:"Global Stores",date:"01 Jan 2026",amount:"â‚¹ 15,900",status:"Paid"})]})]})})]})]})}function _({title:l,value:c,icon:n,color:i}){return t("div",{className:"bg-white rounded-lg shadow p-5 flex justify-between items-center",children:[t("div",{children:[e("p",{className:"text-sm text-gray-500",children:l}),e("h3",{className:"text-xl font-bold text-gray-800",children:c})]}),e("div",{className:`w-12 h-12 rounded-full text-white flex items-center justify-center ${i}`,children:n})]})}function V({label:l,value:c,danger:n}){return t("div",{className:"flex justify-between text-sm",children:[e("span",{className:"text-gray-600",children:l}),e("span",{className:`font-semibold ${n?"text-red-600":"text-gray-800"}`,children:c})]})}function te({invoice:l,customer:c,date:n,amount:i,status:u}){const a=u==="Paid";return t("tr",{className:"border-b last:border-0",children:[e("td",{className:"p-3",children:l}),e("td",{className:"p-3",children:c}),e("td",{className:"p-3",children:n}),e("td",{className:"p-3 text-right",children:i}),e("td",{className:"p-3 text-center",children:e("span",{className:`px-3 py-1 rounded-full text-xs font-medium
            ${a?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:u})})]})}const Y=[{productid:1,productName:"Compact Frame",productPrice:1350,productImageUrl:"/Images/Compect_Fram_Final.png",productDescription:"High-quality compact frame for auto rickshaws."},{productid:2,productName:"Back Door",productPrice:950,productImageUrl:"/Images/Dore_Final.png",productDescription:"Durable metal back door for cargo space."},{productid:3,productName:"Compact Floor 18",productPrice:1200,productImageUrl:"/Images/Flooring_14.png",productDescription:"18-gauge heavy-duty flooring sheet."},{productid:4,productName:"Compact Floor 14",productPrice:1350,productImageUrl:"/Images/flooring_18.png",productDescription:"14-gauge premium flooring sheet."},{productid:5,productName:"Half Star",productPrice:100,productImageUrl:"/Images/Samosa_final.png",productDescription:"Samosa style bracket support."},{productid:6,productName:"Alfa Floor",productPrice:1300,productImageUrl:"/Images/side darvaja.png",productDescription:"Specialized flooring for Alfa models."},{productid:7,productName:"Y Support",productPrice:250,productImageUrl:"/Images/test_new.png",productDescription:"Reinforced Y-shaped structural support."},{productid:8,productName:"GLASS FRAME PASSENGER",productPrice:0,productImageUrl:"/Images/GlassFrame_Pecenger.png",productDescription:"Glass frame for passenger auto rickshaw."},{productid:9,productName:"GLASS FRAME LOADING",productPrice:0,productImageUrl:"/Images/Glass_frame_loading.png",productDescription:"Glass frame for loading auto rickshaw."},{productid:10,productName:"FRONT FLOORING",productPrice:0,productImageUrl:"/Images/FrontFlooring.png",productDescription:"Front flooring sheet."},{productid:11,productName:"FRONT DERA",productPrice:0,productImageUrl:"/Images/FrontDera.png",productDescription:"Front dera body component."},{productid:12,productName:"BODY PASSENGER OLD",productPrice:0,productImageUrl:"/Images/BodyPacengerOld.png",productDescription:"Old model passenger body."},{productid:13,productName:"DELUX PASSENGER BODY",productPrice:0,productImageUrl:"/Images/DeluxPacengerBody.png",productDescription:"Deluxe passenger body."},{productid:14,productName:"COMPLETE TROLLEY O/M",productPrice:0,productImageUrl:"/Images/CompleteTrolyOM.png",productDescription:"Complete trolley old model."},{productid:15,productName:"X.L.D TROLLEY GREEN",productPrice:0,productImageUrl:"/Images/XLDTrollyGreen.png",productDescription:"XLD trolley painted green."},{productid:16,productName:"X.L.D TROLLEY YELLOW",productPrice:0,productImageUrl:"/Images/XLDTrollyYellow.png",productDescription:"XLD trolley painted yellow."},{productid:17,productName:"X.L.D TROLLEY RED",productPrice:0,productImageUrl:"/Images/XLDTrollyRed.png",productDescription:"XLD trolley painted red."},{productid:18,productName:"TROLLEY X.L.D N/M",productPrice:0,productImageUrl:"/Images/XLDTrollyXM.png",productDescription:"XLD trolley new model."},{productid:19,productName:"CITY GLASS FRAME",productPrice:0,productImageUrl:"/Images/ApeCityGlassFrame.png",productDescription:"City model glass frame."},{productid:20,productName:"TROLLEY FLOORING WITH CHANNEL",productPrice:0,productImageUrl:"/Images/TrollyFlooringWithChenal.png",productDescription:"Trolley flooring with support channel."},{productid:21,productName:"TROLLEY FLOORING",productPrice:0,productImageUrl:"/Images/TrollyFlooring.png",productDescription:"Standard trolley flooring."},{productid:22,productName:"LD TROLLEY FLOORING",productPrice:0,productImageUrl:"/Images/LDTrollyFlooring.png",productDescription:"Loading trolley flooring."},{productid:23,productName:"PASSENGER CENTER FLOORING",productPrice:0,productImageUrl:"/Images/PessCenterFlooring.png",productDescription:"Passenger center flooring."},{productid:24,productName:"ENGINE BONNET",productPrice:0,productImageUrl:"/Images/EngenBonnat.png",productDescription:"Engine bonnet cover."},{productid:25,productName:"REAR TAILGATE PASSENGER",productPrice:0,productImageUrl:"/Images/RtelgetPec.png",productDescription:"Passenger rear tailgate."},{productid:26,productName:"DRIVER PARTITION (TAKA)",productPrice:0,productImageUrl:"/Images/DrivPartation.png",productDescription:"Driver partition panel."},{productid:27,productName:"FRONT FALKA LOADING",productPrice:0,productImageUrl:"/Images/FrntFalkaLod.png",productDescription:"Front falka for loading body."},{productid:28,productName:"SIDE FALKA LOADING",productPrice:0,productImageUrl:"/Images/SideFalkaLod.png",productDescription:"Side falka for loading body."},{productid:29,productName:"SIDE PANEL PASSENGER",productPrice:0,productImageUrl:"/Images/SidePanelPecg.png",productDescription:"Passenger side panel."},{productid:30,productName:"TOP",productPrice:0,productImageUrl:"/Images/Top.png",productDescription:"Vehicle top body part."},{productid:31,productName:"DIESEL TANK PATARA",productPrice:0,productImageUrl:"/Images/DesialTankPatra.png",productDescription:"Diesel tank protection patara."},{productid:32,productName:"FRONT CONA BIG PASSENGER",productPrice:0,productImageUrl:"/Images/FrontConeBigPecg.png",productDescription:"Front big cona passenger."},{productid:33,productName:"REAR CONA SMALL PASSENGER",productPrice:0,productImageUrl:"/Images/RearConeSmallPecg.png",productDescription:"Rear small cona passenger."},{productid:34,productName:"FOOT REST",productPrice:0,productImageUrl:"/Images/FootRest.png",productDescription:"Foot rest support."},{productid:35,productName:"TEKA",productPrice:0,productImageUrl:"/Images/Teka.png",productDescription:"Structural teka support."},{productid:36,productName:"COMPLETE DOOR",productPrice:0,productImageUrl:"/Images/CompectDore.png",productDescription:"Complete side door."},{productid:37,productName:"FRONT MUDGUARD",productPrice:0,productImageUrl:"/Images/FrontMudgart.png",productDescription:"Front mudguard."},{productid:38,productName:"FRONT FLOORING CORNER SAMOSA",productPrice:0,productImageUrl:"/Images/FrontFloringRearCorner.png",productDescription:"Front flooring corner samosa."},{productid:39,productName:"FRONT FLOORING REAR CONA",productPrice:0,productImageUrl:"/Images/FrontFloringRearCorner.png",productDescription:"Front flooring rear cona."},{productid:40,productName:"TEKA PILLAR",productPrice:0,productImageUrl:"/Images/TekaPiller.png",productDescription:"Teka pillar support."},{productid:41,productName:"DERA SUPPORT",productPrice:0,productImageUrl:"/Images/DearSupport.png",productDescription:"Dera body support."},{productid:42,productName:"MIRROR CLAMP",productPrice:0,productImageUrl:"/Images/MirrorClamp.png",productDescription:"Mirror clamp holder."},{productid:43,productName:"SIDE MUDGUARD",productPrice:0,productImageUrl:"/Images/SideMudgard.png",productDescription:"Side mudguard."},{productid:44,productName:"HOOD PIPE",productPrice:0,productImageUrl:"/Images/HoodPipe.png",productDescription:"Hood pipe support."},{productid:45,productName:"REAR GUARD",productPrice:0,productImageUrl:"/Images/RearGuard.png",productDescription:"Rear safety guard."}];function Ke({name:l,price:c,image:n,onAdd:i}){return t("div",{className:"group bg-white w-full rounded-xl p-4 shadow-sm hover:shadow-md border border-gray-200 transition-all",children:[e("div",{className:"h-32 w-full overflow-hidden rounded-lg bg-gray-50",children:e("img",{src:n,alt:l,className:"w-full h-full object-contain group-hover:scale-110 transition-transform"})}),e("h3",{className:"mt-3 font-semibold text-sm h-10 overflow-hidden",children:l}),t("p",{className:"text-lg font-bold text-gray-900",children:["â‚¹",c]}),e("button",{onClick:i,className:"w-full mt-3 bg-green-600 text-white py-2 rounded-lg text-sm font-bold hover:bg-black transition-colors",children:"+ Add to Bill"})]})}const We=({isOpen:l,onClose:c,formData:n,setFormData:i,onConfirm:u})=>{if(!l)return null;const a=b=>{const{name:C,value:d,type:v,checked:h}=b.target;i(f=>({...f,[C]:v==="checkbox"?h:d}))};return e("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[100] p-4",children:t("div",{className:"bg-white rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto shadow-2xl",children:[t("div",{className:"p-6 border-b flex justify-between items-center bg-green-700 text-white sticky top-0 z-10",children:[t("div",{children:[e("h2",{className:"text-xl font-bold uppercase tracking-wide",children:"Customer Billing Details"}),e("p",{className:"text-xs text-green-100",children:"KGN Motors Official POS"})]}),e("button",{onClick:c,className:"text-3xl hover:text-gray-200",children:"Ã—"})]}),t("form",{className:"p-6 space-y-6",onSubmit:u,children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Customer / Party Name *"}),e("input",{name:"customerName",type:"text",required:!0,value:n.customerName,onChange:a,className:"w-full border-2 border-gray-200 p-2 rounded-lg focus:border-green-600 outline-none",placeholder:"Full Name"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Phone Number *"}),e("input",{name:"customerPhone",type:"tel",required:!0,value:n.customerPhone,onChange:a,className:"w-full border-2 border-gray-200 p-2 rounded-lg focus:border-green-600 outline-none",placeholder:"Contact No."})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Supplier Name"}),e("input",{name:"supplierName",type:"text",value:n.supplierName,onChange:a,className:"w-full border border-gray-200 p-2 rounded-lg",placeholder:"Optional"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"GST Number"}),e("input",{name:"gstNumber",type:"text",value:n.gstNumber,onChange:a,className:"w-full border border-gray-200 p-2 rounded-lg",placeholder:"22AAAAA0000A1Z5"})]})]}),t("div",{className:"flex items-center gap-3 bg-gray-50 p-4 rounded-xl border-2 border-dashed border-gray-200",children:[e("input",{name:"isVehicle",type:"checkbox",id:"vehicle",checked:n.isVehicle,onChange:a,className:"w-6 h-6 accent-green-700 cursor-pointer"}),e("label",{htmlFor:"vehicle",className:"font-bold text-gray-700 cursor-pointer",children:"Include Vehicle & Driver Details?"})]}),n.isVehicle&&t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-green-50 rounded-xl border border-green-200 transition-all",children:[t("div",{children:[e("label",{className:"block text-xs font-bold text-green-800 mb-1",children:"Driver Name *"}),e("input",{name:"driverName",type:"text",required:n.isVehicle,value:n.driverName,onChange:a,className:"w-full border border-green-300 p-2 rounded-lg bg-white"})]}),t("div",{children:[e("label",{className:"block text-xs font-bold text-green-800 mb-1",children:"Vehicle No. *"}),e("input",{name:"vehicleNumber",type:"text",required:n.isVehicle,value:n.vehicleNumber,onChange:a,className:"w-full border border-green-300 p-2 rounded-lg bg-white",placeholder:"GJ-XX-0000"})]}),t("div",{children:[e("label",{className:"block text-xs font-bold text-green-800 mb-1",children:"Driver Phone *"}),e("input",{name:"driverPhone",type:"tel",required:n.isVehicle,value:n.driverPhone,onChange:a,className:"w-full border border-green-300 p-2 rounded-lg bg-white"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Additional Business Details"}),e("textarea",{name:"businessDetails",value:n.businessDetails,onChange:a,className:"w-full border border-gray-200 p-2 rounded-lg",rows:"2",placeholder:"Address or special notes..."})]}),t("div",{className:"flex gap-4 pt-4 sticky bottom-0 bg-white",children:[e("button",{type:"button",onClick:c,className:"flex-1 px-6 py-3 rounded-xl font-bold border-2 border-gray-200 hover:bg-gray-50 transition-all",children:"Cancel"}),e("button",{type:"submit",className:"flex-1 bg-green-700 text-white px-6 py-3 rounded-xl font-bold hover:bg-black transition-all shadow-lg",children:"Confirm & Generate Bill"})]})]})]})})},Qe=l=>new Promise((c,n)=>{const i=new Image;i.src=l,i.onload=()=>c(i),i.onerror=u=>n(u)}),Je=async(l,c,n,i,u)=>{const a=new ge("p","mm","a4"),b=(i/2).toFixed(2),C="/KGNNewLOGO.png";try{const d=await Qe(C);a.saveGraphicsState(),a.setGState(new a.GState({opacity:.05})),a.addImage(d,"PNG",55,100,100,100),a.restoreGraphicsState(),a.addImage(d,"PNG",14,10,22,22),a.setTextColor(0,100,0),a.setFontSize(22),a.setFont("helvetica","bold"),a.text("KGN MOTORS",40,18),a.setFontSize(8),a.setFont("helvetica","normal"),a.setTextColor(60),a.text("Shop No. 12, Auto Plaza, Near Railway Crossing,",40,23),a.text("Sarkhej Road, Juhapura, Ahmedabad - 380055",40,27),a.text("GSTIN: 24ABCCE1234F1Z5 | State: Gujarat (24)",40,31),a.text("Email: kgnmotors.abd@gmail.com | Mob: +91 99721 XXXXX",40,35),a.setTextColor(0),a.setFontSize(14),a.text("TAX INVOICE",150,18),a.setFontSize(9);const v=`KGN/25-26/${Math.floor(1e3+Math.random()*9e3)}`;a.text(`Invoice No: ${v}`,150,24),a.text(`Date: ${new Date().toLocaleDateString("en-IN")}`,150,29),a.setDrawColor(0,100,0),a.setLineWidth(.5),a.line(14,38,196,38),a.setFont("helvetica","bold"),a.text("BILL TO:",14,46),a.setFont("helvetica","normal"),a.text(`${l.customerName.toUpperCase()}`,14,51),a.text(`Phone: +91 ${l.customerPhone}`,14,56),l.isVehicle&&(a.setFont("helvetica","bold"),a.text("VEHICLE:",120,46),a.setFont("helvetica","normal"),a.text(`No: ${l.vehicleNumber.toUpperCase()}`,120,51),a.text(`Driver: ${l.driverName}`,120,56)),xe(a,{startY:65,head:[["SR.","ITEM DESCRIPTION","QTY","RATE","CGST(9%)","SGST(9%)","AMOUNT"]],body:c.map((o,r)=>{const s=o.productPrice*o.quantity,g=(s*.09).toFixed(2);return[r+1,o.productName.toUpperCase(),o.quantity,o.productPrice.toFixed(2),g,g,(s+parseFloat(g)*2).toFixed(2)]}),theme:"grid",styles:{fontSize:8,cellPadding:3,textColor:[0,0,0]},headStyles:{fillColor:[0,100,0],halign:"center"},columnStyles:{0:{halign:"center",cellWidth:10},1:{cellWidth:55},2:{halign:"center"},3:{halign:"right"},4:{halign:"right"},5:{halign:"right"},6:{halign:"right",fontStyle:"bold"}}});let h=a.lastAutoTable.finalY+10;const f=140,w=196;a.setFontSize(10),a.text("Taxable Value:",f,h),a.text(`${n.toFixed(2)}`,w,h,{align:"right"}),a.text("Total CGST:",f,h+5),a.text(`${b}`,w,h+5,{align:"right"}),a.text("Total SGST:",f,h+10),a.text(`${b}`,w,h+10,{align:"right"}),a.setLineDash([1,1],0),a.line(f,h+13,196,h+13),a.setFont(void 0,"bold"),a.setFontSize(12),a.text("GRAND TOTAL:",f,h+20),a.text(`Rs. ${u.toFixed(2)}`,w,h+20,{align:"right"});const p=270;a.setFontSize(9),a.text("For, KGN MOTORS",150,p-15),a.setLineDash([1,1],0),a.rect(148,p-13,45,15),a.text("Authorised Signatory",153,p+6),window.open(a.output("bloburl"),"_blank"),a.save(`KGN_INV_${Date.now()}.pdf`)}catch(d){console.error("PDF Generation failed",d)}},J={position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0},U=l=>{K.success(l,J)},ne=l=>{K.error(l,J)},j=l=>{K.warn(l,J)},Z=l=>{K.info(l,J)};function et(){const[l]=y(Y),[c,n]=y([]),[i,u]=y(!1),[a,b]=y(""),[C,d]=y("amount"),[v,h]=y(0),[f,w]=y({customerName:"",customerPhone:"",isVehicle:!1,driverName:"",vehicleNumber:"",driverPhone:""}),p=l.filter(N=>N.productName.toLowerCase().includes(a.toLowerCase())),o=N=>{n(T=>T.find(S=>S.productid===N.productid)?T.map(S=>S.productid===N.productid?{...S,quantity:S.quantity+1}:S):[...T,{...N,quantity:1}]),U(`${N.productName} added to cart!`)},r=(N,T)=>{n(q=>q.map(S=>S.productid===N&&S.quantity+T>0?{...S,quantity:S.quantity+T}:S))},s=N=>{n(c.filter(T=>T.productid!==N)),Z("Item removed from cart!")},g=c.reduce((N,T)=>N+T.productPrice*T.quantity,0),I=C==="percent"?g*v/100:v,D=Math.max(g-I,0),P=D*.18,k=D+P,M=async N=>{N.preventDefault(),await Je(f,c,g,I,P),n([]),h(0),u(!1),U("Invoice generated successfully!")};return t("div",{className:"grid grid-rows-[1fr_auto] md:grid-rows-1 md:grid-cols-[1fr_380px] h-screen bg-gray-100 overflow-hidden",children:[t("div",{className:"p-4 md:p-6 overflow-y-auto",children:[e("h1",{className:"text-2xl md:text-3xl font-black text-green-700 mb-2",children:"KGN MOTORS"}),e("input",{className:"w-full mb-4 px-4 py-2 border rounded-lg",placeholder:"Search auto parts...",value:a,onChange:N=>b(N.target.value)}),e("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 xl:grid-cols-5 gap-3 md:gap-4",children:p.map(N=>e(Ke,{name:N.productName,price:N.productPrice,image:N.productImageUrl,onAdd:()=>o(N)},N.productid))})]}),t("div",{className:"grid grid-rows-[auto_1fr_auto] bg-white shadow-xl border-t md:border-t-0",children:[t("div",{className:"bg-green-700 text-white p-4 font-bold",children:["CART (",c.reduce((N,T)=>N+T.quantity,0),")"]}),e("div",{className:"p-3 md:p-4 space-y-3 overflow-y-auto bg-gray-50",children:c.map(N=>t("div",{className:"bg-white p-3 rounded border",children:[t("div",{className:"flex justify-between",children:[e("span",{className:"font-bold text-xs",children:N.productName}),e("button",{onClick:()=>s(N.productid),className:"text-red-500",children:"âœ•"})]}),t("div",{className:"flex justify-between mt-2 items-center",children:[t("div",{className:"flex gap-3 items-center",children:[e("button",{onClick:()=>r(N.productid,-1),children:"-"}),e("span",{children:N.quantity}),e("button",{onClick:()=>r(N.productid,1),children:"+"})]}),t("span",{className:"font-bold",children:["â‚¹",N.productPrice*N.quantity]})]})]},N.productid))}),t("div",{className:"p-4 border-t space-y-2 bg-white",children:[t("div",{className:"flex justify-between",children:[e("span",{children:"Subtotal"}),t("span",{children:["â‚¹",g.toFixed(2)]})]}),t("div",{className:"flex gap-2",children:[t("select",{className:"border px-2",value:C,onChange:N=>d(N.target.value),children:[e("option",{value:"amount",children:"â‚¹"}),e("option",{value:"percent",children:"%"})]}),e("input",{type:"number",className:"border flex-1 px-2",placeholder:"Discount",value:v,onChange:N=>h(+N.target.value)})]}),t("div",{className:"flex justify-between text-red-600 font-bold",children:[e("span",{children:"Discount"}),t("span",{children:["-â‚¹",I.toFixed(2)]})]}),t("div",{className:"flex justify-between",children:[e("span",{children:"GST (18%)"}),t("span",{children:["â‚¹",P.toFixed(2)]})]}),t("div",{className:"flex justify-between text-xl font-black",children:[e("span",{children:"TOTAL"}),t("span",{className:"text-green-700",children:["â‚¹",k.toFixed(2)]})]}),e("button",{onClick:()=>u(!0),disabled:!c.length,className:"w-full mt-4 bg-green-700 text-white py-3 rounded-lg font-bold",children:"PRINT INVOICE"})]})]}),e(We,{isOpen:i,onClose:()=>u(!1),formData:f,setFormData:w,onConfirm:M})]})}function Ne({selectedDate:l,onDateChange:c}){const[n,i]=y(!1),[u,a]=y($()),[b,C]=y([]),d=Se(null);return L(()=>{const v=$(u).startOf("month").startOf("week"),h=$(u).endOf("month").endOf("week"),f=v.clone().subtract(1,"day"),w=[];for(;f.isBefore(h,"day");)w.push(Array(7).fill(0).map(()=>f.add(1,"day").clone()));C(w)},[u]),t("div",{className:"relative w-full",ref:d,children:[e("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-1",children:"Delivery Date"}),t("div",{onClick:()=>i(!n),className:"flex items-center justify-between w-full border border-gray-300 rounded-lg p-2 bg-white cursor-pointer hover:border-green-500 transition-all focus-within:ring-2 focus-within:ring-green-200",children:[e("span",{className:"text-gray-800",children:$(l).format("DD MMM, YYYY")}),e(Le,{className:"text-green-600"})]}),n&&t("div",{className:"absolute z-[100] mt-2 left-0 w-72 bg-white shadow-2xl rounded-xl border border-gray-100 p-4 animate-in fade-in zoom-in duration-200",children:[t("div",{className:"flex justify-between items-center mb-4",children:[e("button",{onClick:()=>a(u.clone().subtract(1,"month")),className:"p-1 hover:bg-green-50 rounded text-green-700",children:e(Oe,{})}),e("h3",{className:"font-bold text-gray-800 text-sm",children:u.format("MMMM YYYY")}),e("button",{onClick:()=>a(u.clone().add(1,"month")),className:"p-1 hover:bg-green-50 rounded text-green-700",children:e(Ee,{})})]}),e("div",{className:"grid grid-cols-7 mb-2 text-center text-[10px] font-bold text-gray-400 uppercase",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(v=>e("div",{children:v},v))}),e("div",{className:"space-y-1",children:b.map((v,h)=>e("div",{className:"grid grid-cols-7",children:v.map((f,w)=>{const p=f.format("YYYY-MM-DD")===l,o=f.isSame(u,"month");return e("button",{onClick:()=>{c(f.format("YYYY-MM-DD")),i(!1)},className:`h-8 w-8 mx-auto flex items-center justify-center rounded-lg text-xs transition-all
                        ${o?"text-gray-700 hover:bg-green-100":"text-gray-200"}
                        ${p?"bg-green-600 text-white shadow-md scale-110":""}
                      `,children:f.date()},w)})},h))})]})]})}function tt(){const[l,c]=y({name:"",date:$().format("YYYY-MM-DD"),poNumber:`PO-${Math.floor(1e3+Math.random()*9e3)}`}),[n,i]=y([{id:1,name:"",qty:1,price:0,total:0}]),[u,a]=y({rowId:null,results:[]}),b=n.reduce((r,s)=>r+s.qty*s.price,0),C=b*.18,d=b+C,v=()=>{i([...n,{id:Date.now(),name:"",qty:1,price:0,total:0}]),U("New item added to the order!")},h=r=>{n.length>1&&i(n.filter(s=>s.id!==r)),Z("Item removed from the order!")},f=(r,s,g)=>{const I=n.map(D=>{if(D.id===r){const P={...D,[s]:g};return P.total=P.qty*P.price,P}return D});if(i(I),s==="name")if(g.length>1){const D=Y.filter(P=>P.productName.toLowerCase().includes(g.toLowerCase()));a({rowId:r,results:D})}else a({rowId:null,results:[]})},w=(r,s)=>{i(n.map(g=>g.id===r?{...g,name:s.productName,price:s.productPrice,total:g.qty*s.productPrice}:g)),a({rowId:null,results:[]})},p=()=>{const r=[["KGN AUTO PARTS - PURCHASE ORDER"],[`PO Number: ${l.poNumber}`],[`Vendor: ${l.name||"N/A"}`],[`Date: ${l.date}`],[""],["Product Description","Quantity","Unit Price (INR)","Total (INR)"]],s=n.map(k=>[k.name,k.qty,k.price,k.total]),g=[["","","Subtotal",b],["","","GST (18%)",C],["","","Grand Total",d]],I=[...r,...s,[""],...g],D=z.utils.aoa_to_sheet(I),P=z.utils.book_new();z.utils.book_append_sheet(P,D,"Purchase Order"),z.writeFile(P,`${l.poNumber}.xlsx`)},o=()=>{const r=new ge,s=[22,163,74];r.setFillColor(...s),r.rect(0,0,210,25,"F"),r.setTextColor(255,255,255),r.setFontSize(14),r.text("KGN AUTO PARTS",14,12),r.setFontSize(8),r.text("Purchase Order Document",14,18),r.setFontSize(12),r.text("PURCHASE ORDER",150,15),r.setTextColor(40,40,40),r.setFontSize(9),r.setFont(void 0,"bold"),r.text("BILL TO:",14,35),r.setFont(void 0,"normal"),r.text("KGN Auto Parts, Ahmedabad, GJ",14,40),r.setFont(void 0,"bold"),r.text("ORDER DETAILS:",130,35),r.setFont(void 0,"normal"),r.text(`Vendor: ${l.name||"N/A"}`,130,40),r.text(`PO Number: ${l.poNumber}`,130,45),r.text(`Date: ${l.date}`,130,50),xe(r,{startY:55,head:[["Description","Qty","Price","Total"]],body:n.map(I=>[I.name,I.qty,I.price.toFixed(2),I.total.toFixed(2)]),theme:"grid",styles:{fontSize:8,cellPadding:2},headStyles:{fillColor:s,textColor:[255,255,255],halign:"center"},columnStyles:{1:{halign:"center"},2:{halign:"right"},3:{halign:"right"}}});const g=r.lastAutoTable.finalY+10;r.setFontSize(9),r.text("Subtotal:",140,g),r.text(`Rs. ${b.toFixed(2)}`,185,g,{align:"right"}),r.text("GST (18%):",140,g+5),r.text(`Rs. ${C.toFixed(2)}`,185,g+5,{align:"right"}),r.setFont(void 0,"bold"),r.setTextColor(...s),r.text("GRAND TOTAL:",140,g+12),r.text(`Rs. ${d.toFixed(2)}`,185,g+12,{align:"right"}),r.save(`${l.poNumber}.pdf`)};return e("div",{className:"p-3 bg-gray-50 min-h-screen",children:t("div",{className:"mx-auto bg-white rounded-xl shadow-lg border border-gray-200 p-8",children:[t("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 border-b pb-6 gap-4",children:[e("div",{children:e("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Purchase Order"})}),t("div",{className:"flex gap-3",children:[t("button",{onClick:p,className:"flex items-center gap-2 bg-emerald-600 text-white px-5 py-2.5 rounded-lg hover:bg-emerald-700 transition font-semibold shadow-md",children:[e(Ue,{})," Excel"]}),t("button",{onClick:o,className:"flex items-center gap-2 bg-rose-600 text-white px-5 py-2.5 rounded-lg hover:bg-rose-700 transition font-semibold shadow-md",children:[e(Me,{})," PDF"]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-10",children:[t("div",{className:"space-y-1",children:[e("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Vendor Name"}),e("input",{type:"text",className:"w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-green-500 outline-none",placeholder:"Supplier name...",value:l.name,onChange:r=>c({...l,name:r.target.value})})]}),t("div",{className:"space-y-1",children:[e("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"PO Number"}),e("input",{type:"text",readOnly:!0,className:"w-full bg-gray-100 border border-gray-300 rounded-lg p-3 text-gray-600 font-mono",value:l.poNumber})]}),e("div",{className:"space-y-1",children:e(Ne,{selectedDate:l.date,onDateChange:r=>c({...l,date:r})})})]}),e("div",{className:"overflow-visible mb-6",children:t("table",{className:"w-full border-collapse",children:[e("thead",{children:t("tr",{className:"bg-green-700 text-white",children:[e("th",{className:"p-4 text-left rounded-tl-lg font-semibold",children:"Product Description"}),e("th",{className:"p-4 text-center font-semibold w-28",children:"Qty"}),e("th",{className:"p-4 text-right font-semibold w-44",children:"Unit Price (â‚¹)"}),e("th",{className:"p-4 text-right font-semibold w-44",children:"Total (â‚¹)"}),e("th",{className:"p-4 text-center rounded-tr-lg w-16"})]})}),e("tbody",{className:"divide-y divide-gray-200",children:n.map(r=>t("tr",{className:"hover:bg-green-50/30 transition",children:[t("td",{className:"p-3 relative",children:[e("input",{autoComplete:"off",type:"text",className:"w-full p-2 border border-transparent focus:border-green-500 focus:bg-white rounded outline-none",placeholder:"Search items...",value:r.name,onChange:s=>f(r.id,"name",s.target.value)}),u.rowId===r.id&&u.results.length>0&&e("div",{className:"absolute z-50 left-2 right-2 mt-1 bg-white border border-gray-300 rounded-xl shadow-2xl max-h-56 overflow-y-auto ring-2 ring-green-500 ring-opacity-20",children:u.results.map(s=>t("div",{className:"p-3 hover:bg-green-600 hover:text-white cursor-pointer flex justify-between items-center transition",onClick:()=>w(r.id,s),children:[e("span",{className:"font-semibold",children:s.productName}),t("span",{className:"text-xs opacity-80 font-mono",children:["â‚¹",s.productPrice]})]},s.productid))})]}),e("td",{className:"p-3",children:e("input",{type:"number",className:"w-full p-2 text-center border border-gray-200 rounded",value:r.qty,onChange:s=>f(r.id,"qty",parseInt(s.target.value)||0)})}),e("td",{className:"p-3",children:e("input",{type:"number",className:"w-full p-2 text-right border border-gray-200 rounded font-mono",value:r.price,onChange:s=>f(r.id,"price",parseFloat(s.target.value)||0)})}),t("td",{className:"p-3 text-right font-bold text-gray-700 font-mono",children:["â‚¹",r.total.toLocaleString()]}),e("td",{className:"p-3 text-center",children:e("button",{onClick:()=>h(r.id),className:"text-gray-400 hover:text-red-600 transition p-2",children:e(me,{})})})]},r.id))})]})}),t("button",{onClick:v,className:"flex items-center gap-2 text-green-700 font-bold hover:text-green-900 transition mb-12 group",children:[e("span",{className:"bg-green-100 p-1 rounded-full group-hover:bg-green-200",children:e(pe,{size:12})})," Add New Product"]}),t("div",{className:"flex flex-col md:flex-row justify-between items-start gap-8 border-t pt-8",children:[t("div",{className:"w-full md:w-1/2",children:[e("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-2",children:"Terms & Conditions"}),e("textarea",{className:"w-full border border-gray-200 rounded-lg p-3 text-sm h-24 text-gray-600 focus:ring-2 focus:ring-green-500 outline-none",placeholder:"Enter notes or terms here..."})]}),t("div",{className:"w-full md:w-1/3 bg-green-50/50 p-6 rounded-xl border border-green-100 space-y-4",children:[t("div",{className:"flex justify-between text-gray-600",children:[e("span",{children:"Subtotal"}),t("span",{className:"font-mono",children:["â‚¹",b.toLocaleString()]})]}),t("div",{className:"flex justify-between text-gray-600",children:[e("span",{children:"GST (18%)"}),t("span",{className:"font-mono",children:["â‚¹",C.toLocaleString()]})]}),t("div",{className:"flex justify-between text-2xl font-black text-green-900 border-t border-green-200 pt-4",children:[e("span",{children:"Total"}),t("span",{children:["â‚¹",d.toLocaleString()]})]}),t("button",{className:"w-full bg-green-700 text-white py-4 rounded-xl font-bold flex items-center justify-center gap-3 hover:bg-green-800 transition shadow-xl mt-4",children:[e(he,{})," Confirm & Submit"]})]})]})]})})}function rt({product:l,onClose:c,onSave:n}){const[i,u]=H(0);if($e(()=>{l&&u(0)},[l]),!l)return null;const a=Math.max(0,l.stock+i);return t("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e("div",{className:"absolute inset-0 bg-black/40",onClick:c}),t("div",{className:"relative z-10 w-full max-w-md rounded-xl bg-white",children:[t("div",{className:"flex justify-between px-5 py-4",children:[t("h3",{className:"font-bold text-lg",children:["Adjust Stock â€“ ",l.productName]}),e("button",{onClick:c,children:e(oe,{className:"h-5 w-5"})})]}),t("div",{className:"space-y-4 px-5 py-4",children:[t("div",{className:"bg-green-700 hover:bg-green-500 p-4 rounded-lg",children:[e("p",{className:"text-sm text-white",children:"Current Stock"}),t("p",{className:"text-2xl font-bold text-white",children:[l.stock," ",l.unit]})]}),t("div",{className:"flex items-center gap-2",children:[e("button",{className:"text-green-500 hover:text-black",onClick:()=>u(b=>b-1),children:e(Ze,{})}),e("input",{type:"number",value:i,onInput:b=>u(+b.target.value),className:"w-24 rounded-lg  text-center p-2 border border-gray-300 text-sm focus:border-green-500 focus:outline-none focus:ring-1 focus:ring-green-500"}),e("button",{className:"text-green-500 hover:text-black",onClick:()=>u(b=>b+1),children:e(qe,{})})]}),t("p",{className:"text-sm",children:["New Stock: ",e("strong",{children:a})]})]}),t("div",{className:"flex justify-end gap-2 px-5 py-4",children:[e("button",{className:"bg-red-700 text-white hover:bg-red-500 px-4 py-2 rounded-md",onClick:c,children:"Cancel"}),t("button",{onClick:()=>n(l.productid,a),className:"flex items-center gap-2 bg-green-700 hover:bg-green-500 text-white px-4 py-2 rounded-md",children:[e(le,{className:"h-4 w-4"}),"Save"]})]})]})]})}function at(){const[l,c]=H((Y??[]).map(d=>({productid:Number(d?.productid??0),productCode:"PRD00"+String(d?.productid??""),productName:String(d?.productName??"Unknown Product"),stock:Number(d?.stock??0),unit:String(d?.unit??""),productPrice:Number(d?.productPrice??0),category:String(d?.category??""),description:String(d?.description??""),productImageUrl:String(d?.productImageUrl??"")}))),[n,i]=H(""),[u,a]=H(null),b=l.filter(d=>d.productName.toLowerCase().includes(n.toLowerCase())),C=(d,v)=>{let h="";c(f=>f.map(w=>w.productid===d?(h=w.productName,{...w,stock:v}):w)),h&&U(`${h} 
 stock updated successfully!`),a(null)};return t("div",{className:"w-full rounded-xl bg-white shadow-md border border-gray-100",children:[t("div",{className:"flex flex-col gap-4 p-5 md:flex-row md:items-center md:justify-between ",children:[e("h2",{className:"text-xl font-semibold text-gray-800",children:"Inventory Update"}),t("div",{className:"flex gap-2",children:[t("div",{className:"relative",children:[e(W,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"}),e("input",{className:"w-64 rounded-lg border border-gray-300 px-10 py-2 text-sm focus:border-green-500 focus:outline-none focus:ring-1 focus:ring-green-500",placeholder:"Search product...",onInput:d=>i(d.target.value)})]}),t("button",{className:"flex items-center gap-2 rounded-lg bg-green-600 px-4 py-2 text-sm font-medium text-white hover:bg-green-700",children:[e(Ye,{className:"h-4 w-4"}),"Download"]})]})]}),t("div",{className:"overflow-y-auto",style:{maxHeight:"67vh"},children:[t("table",{className:"w-full text-left rounded-xl text-sm table-auto",children:[e("thead",{className:"sticky top-0 bg-green-500 z-10 rounded-xl",children:t("tr",{className:"bg-green-700 text-white rounded-t-lg",children:[e("th",{className:"p-4 font-medium text-white",children:"Code"}),e("th",{className:"p-4 font-medium text-white",children:"Product"}),e("th",{className:"p-4 font-medium text-white",children:"Stock"}),e("th",{className:"p-4 font-medium text-white",children:"Price"}),e("th",{className:"p-4 font-medium text-white",children:"Action"})]})}),e("tbody",{children:b.map((d,v)=>t("tr",{className:"last:border-none hover:bg-green-100",children:[e("td",{className:"p-4 text-gray-700",children:d.productCode}),e("td",{className:"p-4",children:t("div",{className:"flex items-center gap-3",children:[e("img",{src:d.productImageUrl,alt:d.productName,className:"h-9 w-9 rounded-full object-cover border"}),e("span",{className:"font-medium text-gray-800",children:d.productName})]})}),e("td",{className:"p-4",children:t("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-xs font-medium ${d.stock>20?"bg-green-100 text-green-700":d.stock>5?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:[d.stock," ",d.unit]})}),e("td",{className:"p-4 text-gray-700",children:d.productPrice}),e("td",{className:"p-4",children:e("button",{className:"rounded-md p-2 text-green-600 hover:bg-green-500/100 hover:text-white",title:"Update Stock",onClick:()=>a(d),children:e(Q,{className:"h-4 w-4"})})})]},d.productId+"-"+v))})]}),e(rt,{product:u,onClose:()=>a(null),onSave:C})]})]})}function ot({isOpen:l,onClose:c,onSave:n,item:i}){const[u,a]=y({productCode:"",productName:"",category:"",unit:"",productPrice:"",stock:"",description:"",productImage:null}),[b,C]=y({}),[d,v]=y(null);L(()=>{i?(a({productCode:i.productCode||"",productName:i.productName||"",category:i.category||"",unit:i.unit||"",productPrice:i.productPrice||"",stock:i.stock||"",description:i.description||"",productImage:null}),v(i.productImageUrl||null)):(a({productCode:"",productName:"",category:"",unit:"",productPrice:"",description:"",productImage:null}),v(null))},[i]);const h=p=>{const{name:o,value:r}=p.target;a(s=>({...s,[o]:r}))},f=p=>{const o=p.target.files[0];o&&(a(r=>({...r,productImage:o})),v(URL.createObjectURL(o)))},w=p=>{p.preventDefault();const o={};u.productCode||(o.productCode="Required"),u.productName||(o.productName="Required"),u.category||(o.category="Required"),u.unit||(o.unit="Required"),u.productPrice||(o.productPrice="Required"),C(o),!Object.keys(o).length&&(n({...u,id:i?.productid}),c())};return l?t("div",{className:"fixed inset-0 z-50 flex items-center justify-center",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:[e("div",{className:"absolute inset-0 bg-black/50",onClick:c}),t("div",{className:"relative z-10 w-full max-w-2xl rounded-xl bg-white shadow-2xl flex flex-col max-h-[90vh]",children:[t("div",{className:"sticky top-0 flex items-center justify-between px-6 py-4 bg-green-700 text-white rounded-t-xl",children:[e("h2",{id:"modal-title",className:"text-lg font-semibold",children:i?"Update Item":"Add New Item"}),e("button",{onClick:c,"aria-label":"Close modal",className:"hover:text-green-200",children:e(oe,{className:"h-5 w-5"})})]}),e("div",{className:"px-6 py-5 overflow-y-auto",children:t("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[[["productCode","Product Code"],["productName","Product Name"],["category","Category"],["unit","Unit"]].map(([p,o])=>t("div",{className:"flex flex-col gap-1",children:[e("label",{htmlFor:p,className:"text-sm font-medium",children:o}),e("input",{id:p,name:p,value:u[p],onChange:h,className:"input"}),b[p]&&e("span",{className:"text-xs text-red-600",children:b[p]})]},p)),t("div",{className:"flex flex-col gap-1",children:[e("label",{className:"text-sm font-medium",children:"Price (â‚¹)"}),e("input",{type:"number",name:"productPrice",value:u.productPrice,onChange:h,className:"input"}),b.productPrice&&e("span",{className:"text-xs text-red-600",children:b.productPrice})]}),t("div",{className:"md:col-span-2 flex flex-col gap-1",children:[e("label",{className:"text-sm font-medium",children:"Description"}),e("textarea",{name:"description",value:u.description,onChange:h,className:"input min-h-[90px]"})]}),t("div",{className:"md:col-span-2 flex flex-col gap-3",children:[e("label",{className:"text-sm font-medium",children:"Product Image"}),e("input",{type:"file",accept:"image/*",onChange:f}),d&&e("img",{src:d,alt:"Product preview",className:"h-32 w-32 rounded-lg object-cover border"})]})]})}),t("div",{className:"sticky bottom-0 flex justify-end gap-3 px-6 py-4 border-t bg-white rounded-b-xl",children:[e("button",{onClick:c,className:"px-4 py-2 clear-button",children:"Cancel"}),t("button",{onClick:w,className:"flex items-center gap-2 primary-button px-4 py-2",children:[e(le,{className:"h-4 w-4"}),i?"Update":"Save"]})]})]})]}):null}function lt(){const[l,c]=y([]);L(()=>{const o=(Y??[]).map(r=>({productid:Number(r?.productid??0),productCode:"PRD00"+String(r?.productid??""),productName:r?.productName??"Unknown Product",stock:Number(r?.stock??0),unit:r?.unit??"",productPrice:Number(r?.productPrice??0),category:r?.category??"",description:r?.description??"",productImageUrl:r?.productImageUrl??""}));c(o)},[]);const[n,i]=ee.useState(""),u=l.filter(o=>o.productName.toLowerCase().includes(n.toLowerCase())),[a,b]=ee.useState(!1),[C,d]=ee.useState(null),v=()=>{d(null),b(!0)},h=o=>{d(o),b(!0)},f=()=>{b(!1)},w=o=>{o&&o.productName&&o.productName,c(r=>{const s=r.findIndex(g=>g.productid===o.id);if(s!==-1){const g=[...r];return g[s]={...g[s],...o,productid:o.id},g}else return[...r,{...o,productid:o.id??Date.now(),productCode:o.productCode??`PRD00${o.id??Date.now()}`}]}),f(),U("Item saved successfully!")},p=o=>{const r=Number(o);return Number.isFinite(r)?r.toFixed(2):"0.00"};return t("div",{className:"w-full rounded-xl bg-white shadow-md border border-gray-100",children:[t("div",{className:"flex flex-col gap-4 p-5 md:flex-row md:items-center md:justify-between ",children:[e("h2",{className:"text-xl font-semibold text-gray-800",children:"Item List"}),t("div",{className:"flex gap-2",children:[t("div",{className:"relative",children:[e(W,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"}),e("input",{className:"w-64 rounded-lg border border-gray-300 px-10 py-2 text-sm focus:border-green-500 focus:outline-none focus:ring-1 focus:ring-green-500",placeholder:"Search product...",onInput:o=>i(o.target.value)})]}),t("button",{className:"flex items-center gap-1 px-2 py-2 primary-button",onClick:()=>v(),children:[e(re,{className:"h-5 w-5"}),e("span",{children:"Add  Item"})]})]})]}),e("div",{className:"overflow-y-auto",style:{maxHeight:"67vh"},children:t("table",{className:"w-full text-left rounded-xl text-sm table-auto",children:[e("thead",{className:"sticky top-0 bg-green-700 z-10 rounded text-white",children:t("tr",{children:[e("th",{className:"px-4 py-3",children:"Item Code"}),e("th",{className:"px-4 py-3",children:"Item Name"}),e("th",{className:"px-4 py-3",children:"Category"}),e("th",{className:"px-4 py-3",children:"Unit"}),e("th",{className:"px-4 py-3",children:"Price (â‚¹)"}),e("th",{className:"px-4 py-3 text-right",children:"Actions"})]})}),e("tbody",{children:u.map((o,r)=>t("tr",{className:"last:border-none hover:bg-green-100",children:[e("td",{className:"px-4 py-3 text-gray-700",children:o.productCode}),e("td",{className:"px-4 py-3 font-medium text-gray-800",children:o.productName}),e("td",{className:"px-4 py-3 text-gray-700",children:o.category}),e("td",{className:"px-4 py-3 text-gray-700",children:o.unit}),e("td",{className:"px-4 py-3 text-gray-700",children:p(o.productPrice)}),e("td",{className:"px-4 py-3",children:t("div",{className:"flex justify-end gap-2",children:[t("div",{className:"relative group",children:[e("button",{id:`edit-btn-${o.productId_index}`,onClick:()=>h(o),className:"inline-flex items-center justify-center rounded-md p-2 secondary-button","aria-label":"Edit item",children:e(Q,{className:"h-4 w-4 text-white"})}),e(E,{anchorId:`edit-btn-${o.productId_index}`,content:"Edit",place:"top"})]}),t("div",{className:"relative group",children:[e("button",{id:`delete-btn-${o.productId_index}`,onClick:()=>handleDeleteClick(o),className:"inline-flex items-center justify-center clear-button p-2","aria-label":"Delete item",children:e(ae,{className:"h-4 w-4 text-white"})}),e(E,{anchorId:`delete-btn-${o.productId_index}`,content:"Delete",place:"top"})]})]})})]},o.productId+"-"+r))})]})}),e(ot,{isOpen:a,onClose:f,onSave:w,item:C})]})}const fe=[{customerId:1,customerCode:"CUST001",customerName:"John Doe",phone:"+1234567890",alternatePhone:"+0987654321",email:"john.doe@example.com",address:"123 Main St, California",gstin:"22AAAAA0000A1Z5",state:"California",stateCode:"06",customerType:"Regular",creditLimit:5e3,loyaltyPoints:150,notes:"Preferred customer",isActive:!0,customerPhoto:"path/to/photo.jpg",createdAt:"2023-01-15T10:00:00Z",updatedAt:"2024-05-20T15:30:00Z"},{customerId:2,customerCode:"CUST002",customerName:"Alice Smith",phone:"+919876543210",alternatePhone:"+919812345678",email:"alice.smith@example.com",address:"45 Sunset Blvd, Texas",gstin:"22AAAAA0001A1Z2",state:"Texas",stateCode:"48",customerType:"Wholesale",creditLimit:12e3,loyaltyPoints:320,notes:"High volume buyer",isActive:!0,customerPhoto:"path/to/photo.jpg",createdAt:"2023-03-12T09:20:00Z",updatedAt:"2024-04-11T11:45:00Z"},{customerId:3,customerCode:"CUST003",customerName:"Robert Brown",phone:"+919998887776",alternatePhone:"+919911223344",email:"robert.brown@example.com",address:"88 Lake View, New York",gstin:"22AAAAA0002A1Z3",state:"New York",stateCode:"36",customerType:"Retail",creditLimit:3e3,loyaltyPoints:80,notes:"Walk-in customer",isActive:!0,customerPhoto:"path/to/photo.jpg",createdAt:"2023-06-01T14:10:00Z",updatedAt:"2024-02-10T16:00:00Z"},{customerId:4,customerCode:"CUST004",customerName:"Emily Johnson",phone:"+918888777666",alternatePhone:"+918877665544",email:"emily.johnson@example.com",address:"12 Palm Street, Florida",gstin:"22AAAAA0003A1Z4",state:"Florida",stateCode:"12",customerType:"Regular",creditLimit:7e3,loyaltyPoints:210,notes:"Long-term customer",isActive:!0,customerPhoto:"path/to/photo.jpg",createdAt:"2023-04-18T08:30:00Z",updatedAt:"2024-03-21T12:40:00Z"},{customerId:5,customerCode:"CUST005",customerName:"Michael Lee",phone:"+917777666555",alternatePhone:"+917766554433",email:"michael.lee@example.com",address:"76 Green Road, Illinois",gstin:"22AAAAA0004A1Z5",state:"Illinois",stateCode:"17",customerType:"Wholesale",creditLimit:15e3,loyaltyPoints:400,notes:"Priority client",isActive:!0,customerPhoto:"path/to/photo.jpg",createdAt:"2023-02-25T10:15:00Z",updatedAt:"2024-05-05T09:50:00Z"},{customerId:6,customerCode:"CUST006",customerName:"David Wilson",phone:"+916666555444",alternatePhone:"+916655443322",email:"david.wilson@example.com",address:"9 River Side, Texas",gstin:"22AAAAA0005A1Z6",state:"Texas",stateCode:"48",customerType:"Retail",creditLimit:4e3,loyaltyPoints:120,notes:"Occasional buyer",isActive:!0,customerPhoto:"path/to/photo.jpg",createdAt:"2023-07-10T15:45:00Z",updatedAt:"2024-01-18T10:20:00Z"},{customerId:7,customerCode:"CUST007",customerName:"Sophia Miller",phone:"+915555444333",alternatePhone:"+915544332211",email:"sophia.miller@example.com",address:"54 Ocean Drive, California",gstin:"22AAAAA0006A1Z7",state:"California",stateCode:"06",customerType:"Regular",creditLimit:6500,loyaltyPoints:190,notes:"Online orders only",isActive:!0,customerPhoto:"path/to/photo.jpg",createdAt:"2023-05-05T11:10:00Z",updatedAt:"2024-04-01T14:00:00Z"},{customerId:8,customerCode:"CUST008",customerName:"Daniel Anderson",phone:"+914444333222",alternatePhone:"+914433221100",email:"daniel.anderson@example.com",address:"67 Hill Road, New York",gstin:"22AAAAA0007A1Z8",state:"New York",stateCode:"36",customerType:"Wholesale",creditLimit:11e3,loyaltyPoints:350,notes:"Bulk purchaser",isActive:!0,customerPhoto:"path/to/photo.jpg",createdAt:"2023-08-15T09:00:00Z",updatedAt:"2024-05-02T17:30:00Z"},{customerId:9,customerCode:"CUST009",customerName:"Olivia Thomas",phone:"+913333222111",alternatePhone:"+913322110099",email:"olivia.thomas@example.com",address:"22 Forest Lane, Florida",gstin:"22AAAAA0008A1Z9",state:"Florida",stateCode:"12",customerType:"Retail",creditLimit:2800,loyaltyPoints:60,notes:"New customer",isActive:!0,customerPhoto:"path/to/photo.jpg",createdAt:"2024-01-05T13:20:00Z",updatedAt:"2024-05-10T10:10:00Z"},{customerId:10,customerCode:"CUST010",customerName:"James Taylor",phone:"+912222111000",alternatePhone:"+912211009988",email:"james.taylor@example.com",address:"90 Central Ave, Illinois",gstin:"22AAAAA0009A1Z0",state:"Illinois",stateCode:"17",customerType:"Regular",creditLimit:8e3,loyaltyPoints:240,notes:"Repeat buyer",isActive:!0,customerPhoto:"path/to/photo.jpg",createdAt:"2023-09-01T10:00:00Z",updatedAt:"2024-05-15T16:45:00Z"}],nt=[{categoryId:1,categoryCode:"ELEC",categoryName:"Electronics",description:"Electronic items including gadgets and appliances.",createdAt:"2023-01-15T10:00:00Z",updatedAt:"2024-05-20T15:30:00Z"},{categoryId:2,categoryCode:"FASH",categoryName:"Fashion",description:"Clothing, footwear, and accessories.",createdAt:"2023-02-10T11:15:00Z",updatedAt:"2024-04-18T12:00:00Z"},{categoryId:3,categoryCode:"HOME",categoryName:"Home & Living",description:"Furniture, decor, and household items.",createdAt:"2023-03-05T09:30:00Z",updatedAt:"2024-03-22T14:45:00Z"},{categoryId:4,categoryCode:"SPORTS",categoryName:"Sports & Outdoors",description:"Sporting goods and outdoor equipment.",createdAt:"2023-04-12T13:20:00Z",updatedAt:"2024-02-28T16:10:00Z"},{categoryId:5,categoryCode:"BEAUTY",categoryName:"Beauty & Personal Care",description:"Cosmetics, skincare, and personal hygiene products.",createdAt:"2023-05-18T15:40:00Z",updatedAt:"2024-01-30T10:25:00Z"},{categoryId:6,categoryCode:"TOYS",categoryName:"Toys & Games",description:"Toys, games, and puzzles for children of all ages.",createdAt:"2023-06-22T10:50:00Z",updatedAt:"2024-06-10T11:55:00Z"}],ct=async()=>fe,st=async()=>nt,dt=l=>fe.find(c=>c.customerId===l);function it({isOpen:l,onClose:c,onSave:n,customer:i}){const[u,a]=y({customerId:"",customerName:"",phone:"",email:"",customerType:"",city:"",state:"",country:"",zipCode:"",address:"",gstin:"",notes:"",creditLimit:"",isActive:!0,description:"",customerPhoto:null}),[b,C]=y({}),[d,v]=y(null);if(L(()=>{i?.customerId?(async()=>{try{const o=await dt(i.customerId);a(o),v(o.customerPhoto||null)}catch(o){console.error("Failed to fetch customer:",o),ne("Failed to fetch customer details.")}})():(a({customerId:"",customerName:"",phone:"",email:"",customerType:"",city:"",state:"",country:"",zipCode:"",address:"",gstin:"",notes:"",creditLimit:"",isActive:!0,description:"",customerPhoto:null}),v(null))},[i]),!l)return null;const h=o=>{const{name:r,value:s,type:g,checked:I}=o.target;a(D=>({...D,[r]:g==="checkbox"?I:s}))},f=o=>{const r=o.target.files[0];r&&(a(s=>({...s,customerPhoto:r})),v(URL.createObjectURL(r)))},w=o=>/^\+?[1-9]\d{1,14}$/.test(o),p=()=>{if(!u.customerName.trim()){C({customerName:"Customer name is required"});return}if(u.phone&&!w(u.phone)){C({phone:"Invalid phone number format"});return}C({}),n(u)};return t("div",{className:"fixed inset-0 z-50 flex items-center justify-center",role:"dialog","aria-modal":"true",children:[e("div",{className:"absolute inset-0 bg-black/50",onClick:c}),t("div",{className:"relative z-10 w-full max-w-2xl rounded-xl bg-white shadow-2xl flex flex-col max-h-[90vh]",children:[t("div",{className:"sticky top-0 flex items-center justify-between px-6 py-4 bg-green-700 text-white rounded-t-xl",children:[e("h2",{className:"text-lg font-semibold",children:i?"Update Customer":"Add New Customer"}),e("button",{onClick:c,"aria-label":"Close modal",children:e(oe,{className:"h-5 w-5"})})]}),e("div",{className:"px-6 py-5 overflow-y-auto",children:t("form",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[[["customerId","Customer Code"],["customerName","Customer Name"],["phone","Phone"],["email","Email"],["customerType","Customer Type"],["city","City"],["state","State"],["country","Country"],["zipCode","Zip Code"],["address","Address"],["gstin","GST Number"],["notes","Note"],["creditLimit","Credit Limit"]].map(([o,r])=>t("div",{className:"flex flex-col gap-1",children:[e("label",{className:"text-sm font-medium",children:r}),e("input",{name:o,value:u[o]||"",onChange:h,className:"input"}),b[o]&&e("span",{className:"text-xs text-red-600",children:b[o]})]},o)),t("div",{className:"flex flex-col gap-1",children:[e("label",{className:"text-sm font-medium",children:"Active"}),e("input",{type:"checkbox",name:"isActive",checked:u.isActive,onChange:h})]}),t("div",{className:"md:col-span-2 flex flex-col gap-1",children:[e("label",{className:"text-sm font-medium",children:"Description"}),e("textarea",{name:"description",value:u.description,onChange:h,className:"input min-h-[90px]"})]}),t("div",{className:"md:col-span-2 flex flex-col gap-3",children:[e("label",{className:"text-sm font-medium",children:"Customer Image"}),e("input",{type:"file",accept:"image/*",onChange:f}),d&&e("img",{src:d,alt:"Preview",className:"h-32 w-32 rounded-lg object-cover border"})]})]})}),t("div",{className:"sticky bottom-0 flex justify-end gap-3 px-6 py-4 border-t bg-white rounded-b-xl",children:[e("button",{onClick:c,className:"px-4 py-2 clear-button",children:"Cancel"}),t("button",{onClick:p,className:"flex items-center gap-2 primary-button px-4 py-2",children:[e(le,{className:"h-4 w-4"}),i?"Update":"Save"]})]})]})]})}function ut(){const[l,c]=y([]),[n,i]=y("");L(()=>{(async()=>{try{const s=await ct();c(s||[])}catch{ne("Failed to fetch customers.")}})()},[]);const u=l.filter(r=>(r.customerName||"").toLowerCase().includes(n.toLowerCase())),a=r=>{if(!r)return"-";const s=new Date(r);return isNaN(s.getTime())?"-":s.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},[b,C]=y(!1),[d,v]=y(null),h=()=>{v(null),C(!0)},f=r=>{v(r),C(!0)},w=r=>{c(s=>s.filter(g=>g.customerId!==r.customerId)),Z(`${r.customerName} deleted`)},p=()=>C(!1),o=r=>{c(s=>s.some(I=>I.customerId===r.customerId)?s.map(I=>I.customerId===r.customerId?r:I):[...s,r]),U(`${r.customerName||"Customer"} saved successfully!`),p()};return t("div",{className:"w-full rounded-xl bg-white shadow-md border border-gray-100",children:[t("div",{className:"flex flex-col gap-4 p-5 md:flex-row md:items-center md:justify-between",children:[e("h2",{className:"text-xl font-semibold text-green-800",children:"Customer Master"}),t("div",{className:"flex gap-2",children:[t("div",{className:"relative",children:[e(W,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"}),e("input",{className:"w-64 rounded-lg border border-gray-300 px-10 py-2 text-sm focus:border-green-500 focus:outline-none focus:ring-1 focus:ring-green-500",placeholder:"Search customer...",value:n,onChange:r=>i(r.target.value)})]}),t("button",{className:"flex items-center gap-1 px-2 py-2 primary-button",onClick:h,children:[e(re,{className:"h-5 w-5"}),e("span",{children:"Add Customer"})]})]})]}),e("div",{className:"overflow-y-auto",style:{maxHeight:"67vh"},children:t("table",{className:"w-full text-sm table-auto",children:[e("thead",{className:"sticky top-0 bg-green-700 z-10 text-white",children:t("tr",{children:[e("th",{className:"px-4 py-3",children:"Customer Code"}),e("th",{className:"px-4 py-3",children:"Customer Name"}),e("th",{className:"px-4 py-3",children:"Phone"}),e("th",{className:"px-4 py-3",children:"Email"}),e("th",{className:"px-4 py-3",children:"Customer Type"}),e("th",{className:"px-4 py-3",children:"Active"}),e("th",{className:"px-4 py-3",children:"Created Date"}),e("th",{className:"px-4 py-3",children:"Last Updated"}),e("th",{className:"px-4 py-3 text-right",children:"Actions"})]})}),e("tbody",{children:u.map((r,s)=>{const g=`${r.customerId}-${s}`;return t("tr",{className:"hover:bg-green-100",children:[e("td",{className:"px-4 py-3",children:r.customerCode}),e("td",{className:"px-4 py-3 font-medium",children:r.customerName}),e("td",{className:"px-4 py-3",children:r.phone}),e("td",{className:"px-4 py-3",children:r.email}),e("td",{className:"px-4 py-3",children:r.customerType}),e("td",{className:"px-4 py-3",children:r.isActive?"Yes":"No"}),e("td",{className:"px-4 py-3",children:a(r.createdAt)}),e("td",{className:"px-4 py-3",children:a(r.updatedAt)}),e("td",{className:"px-4 py-3",children:t("div",{className:"flex justify-end gap-2",children:[e("button",{id:`edit-${g}`,onClick:()=>f(r),className:"secondary-button p-2",children:e(Q,{className:"h-4 w-4 text-white"})}),e(E,{anchorId:`edit-${g}`,content:"Edit"}),e("button",{id:`delete-${g}`,onClick:()=>w(r),className:"clear-button p-2",children:e(ae,{className:"h-4 w-4 text-white"})}),e(E,{anchorId:`delete-${g}`,content:"Delete"})]})})]},g)})})]})}),e(it,{isOpen:b,onClose:p,onSave:o,customer:d})]})}function mt(){const[l,c]=y([]),[n,i]=y(""),[u,a]=y(!1),[b,C]=y(null);L(()=>{(async()=>{try{const o=await st();c(Array.isArray(o)?o:[])}catch(o){console.error(o),ne("Failed to fetch categories.")}})()},[]);const d=X(()=>l.filter(p=>(p.categoryName||"").toLowerCase().includes(n.toLowerCase())),[l,n]),v=p=>{if(!p)return"-";const o=new Date(p);return isNaN(o.getTime())?"-":o.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},h=()=>{C(null),a(!0)},f=p=>{C(p),a(!0)},w=p=>{c(o=>o.filter(r=>r.categoryId!==p.categoryId)),Z(`${p.categoryName||"Category"} deleted`)};return t("div",{className:"w-full rounded-xl bg-white shadow-md border border-gray-100",children:[t("div",{className:"flex flex-col gap-4 p-5 md:flex-row md:items-center md:justify-between",children:[e("h2",{className:"text-xl font-semibold text-green-800",children:"Category Master"}),t("div",{className:"flex gap-2",children:[t("div",{className:"relative",children:[e(W,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"}),e("input",{className:"w-64 rounded-lg border border-gray-300 px-10 py-2 text-sm focus:border-green-500 focus:outline-none focus:ring-1 focus:ring-green-500",placeholder:"Search category...",value:n,onChange:p=>i(p.target.value)})]}),t("button",{className:"flex items-center gap-1 px-2 py-2 primary-button",onClick:h,children:[e(re,{className:"h-5 w-5"}),e("span",{children:"Add Category"})]})]})]}),e("div",{className:"overflow-y-auto",style:{maxHeight:"67vh"},children:t("table",{className:"w-full text-sm table-auto",children:[e("thead",{className:"sticky top-0 bg-green-700 z-10 text-white",children:t("tr",{children:[e("th",{className:"px-4 py-3 text-left",children:"Category Code"}),e("th",{className:"px-4 py-3  text-left",children:"Category Name"}),e("th",{className:"px-4 py-3  text-left",children:"Created Date"}),e("th",{className:"px-4 py-3 text-left",children:"Last Updated"}),e("th",{className:"px-4 py-3 text-right",children:"Actions"})]})}),t("tbody",{children:[d.length===0&&e("tr",{children:e("td",{colSpan:5,className:"px-4 py-6 text-center text-gray-500",children:"No categories found"})}),d.map((p,o)=>{const r=`${p.categoryId}-${o}`;return t("tr",{className:"hover:bg-green-100",children:[e("td",{className:"px-4 py-3",children:p.categoryCode||"-"}),e("td",{className:"px-4 py-3 font-medium",children:p.categoryName}),e("td",{className:"px-4 py-3",children:v(p.createdAt)}),e("td",{className:"px-4 py-3",children:v(p.updatedAt)}),e("td",{className:"px-4 py-3",children:t("div",{className:"flex justify-end gap-2",children:[e("button",{id:`edit-${r}`,onClick:()=>f(p),className:"secondary-button p-2",children:e(Q,{className:"h-4 w-4 text-white"})}),e(E,{anchorId:`edit-${r}`,content:"Edit"}),e("button",{id:`delete-${r}`,onClick:()=>w(p),className:"clear-button p-2",children:e(ae,{className:"h-4 w-4 text-white"})}),e(E,{anchorId:`delete-${r}`,content:"Delete"})]})})]},r)})]})]})})]})}function pt(){const c=m=>Math.round((m+Number.EPSILON)*100)/100,[n,i]=y({name:""}),[u,a]=y(""),[b,C]=y(""),[d,v]=y(new Date().toISOString().split("T")[0]),[h,f]=y([]),[w,p]=y({rowId:null,results:[]}),[o,r]=y(-1),[s,g]=y(0),[I,D]=y(!1);L(()=>{r(-1)},[w]);const P=X(()=>h.reduce((m,x)=>m+x.qty*x.price,0),[h]),k=X(()=>c(P*.18),[P]),M=X(()=>c(P+k),[P,k]),N=Math.max(M-s,0),T=()=>{f(m=>[...m,{id:crypto.randomUUID(),name:"",qty:0,price:0}])},q=m=>{h.length>1&&(f(h.filter(x=>x.id!==m)),Z("Item removed from the order!"))},S=(m,x,A)=>{const we=h.map(G=>{if(G.id===m){const O={...G,[x]:A};return O.total=O.qty*O.price,O}return G});if(f(we),x==="name"&&A.length>1){const G=Y.filter(O=>O.productName.toLowerCase().includes(A.toLowerCase()));p({rowId:m,results:G})}else x==="name"&&p({rowId:null,results:[]})},ce=(m,x)=>{f(h.map(A=>A.id===m?{...A,name:x.productName,price:x.productPrice,total:A.qty*x.productPrice}:A)),p({rowId:null,results:[]})},se=h.some(m=>!m.name.trim()),be=()=>{let m=`ðŸ‘‹ Hello ${n.name},

`;return m+=`ðŸ¢ *K.G.N. Auto Parts*
`,m+=`ðŸ§¾ *Sales Order Confirmation*
`,m+=`ðŸ“… Delivery Date: ${d}

`,m+=`ðŸ›’ *Order Summary*
`,m+=`--------------------------------
`,h.forEach((x,A)=>{m+=`*${A+1}. ${x.name}*
`,m+=`   Qty: ${x.qty} Ã— â‚¹${x.price} = â‚¹${x.total}
`,m+=`--------------------------------
`}),m+=`ðŸ’° *Subtotal:* â‚¹${P}
`,m+=`ðŸ§¾ *GST (18%):* â‚¹${k}
`,m+=`ðŸ’µ *Advance Paid:* â‚¹${s}
`,m+=`ðŸ”” *Balance Due:* â‚¹${N}

`,m+=`ðŸ“Ž *Please find the Sales Order PDF attached.*

`,m+="ðŸ™ Thank you for choosing *[Your Company Name]*! We appreciate your business.",encodeURIComponent(m)},ye=()=>{if(!I){j("Please confirm before sending the order!");return}if(!h.length)return;const m=be(),x=ve(u);if(n.name.trim()===""){j("Please enter customer name.");return}if(d.trim()===""){j("Please select delivery date.");return}if(N<=0){j("Balance amount should be greater than zero.");return}const A=`https://wa.me/${x}?text=${m}`;window.open(A,"_blank")};function ve(m){const x=m.replace(/\D/g,"");return/^[1-9]\d{9}$/.test(x)}return t("div",{className:"p-6 bg-gray-50 min-h-screen",children:[e("h1",{className:"text-2xl font-bold mb-4",children:"Sales Order"}),t("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6",children:[t("div",{children:[e("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Customer Name"}),e("input",{type:"text",value:n.name,onChange:m=>i({name:m.target.value}),className:"w-full input p-3"})]}),t("div",{children:[e("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Contact"}),e(ze,{defaultCountry:"in",value:u,onChange:a})]}),e("div",{children:e(Ne,{selectedDate:d,onDateChange:v})})]}),e("div",{className:"grid grid-cols-1",children:t("div",{children:[e("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Address"}),e("textarea",{type:"text",value:b.name,onChange:m=>C({name:m.target.value}),className:"w-full input p-3",rows:2})]})}),e("div",{children:t("table",{className:"w-full text-left rounded-xl text-sm table-auto",children:[e("thead",{className:"main-table-header",children:t("tr",{children:[e("th",{className:"p-4 text-left rounded-tl-lg font-semibold",children:"Product"}),e("th",{className:"p-4 text-center font-semibold w-28",children:"Qty"}),e("th",{className:"p-4 text-right font-semibold w-44",children:"Unit Price (â‚¹)"}),e("th",{className:"p-4 text-right font-semibold w-44",children:"Total (â‚¹)"}),e("th",{className:"p-4 text-center rounded-tr-lg w-16"})]})}),e("tbody",{className:"divide-y divide-gray-200",children:h.map(m=>t("tr",{className:"hover:bg-green-50/30 transition",children:[t("td",{className:"p-3 relative",children:[e("input",{autoComplete:"off",type:"text",className:"w-full p-2 border border-transparent focus:border-green-500 focus:bg-white rounded outline-none",placeholder:"Search items...",value:m.name,onChange:x=>S(m.id,"name",x.target.value),onKeyDown:x=>{w.rowId===m.id&&(x.key==="ArrowDown"&&(x.preventDefault(),r(A=>A<w.results.length-1?A+1:0)),x.key==="ArrowUp"&&(x.preventDefault(),r(A=>A>0?A-1:w.results.length-1)),x.key==="Enter"&&o>=0&&(x.preventDefault(),ce(m.id,w.results[o])),x.key==="Escape"&&r(-1))}}),w.rowId===m.id&&w.results.length>0&&e("div",{className:"absolute left-0 right-0 top-full mt-1 bg-white z-50 max-h-60 overflow-y-auto border border-gray-200 rounded",children:w.results.map((x,A)=>t("div",{className:`p-3 cursor-pointer flex justify-between ${o===A?"bg-green-600 text-white":"hover:bg-green-600 hover:text-white"}`,onMouseEnter:()=>r(A),onClick:()=>ce(m.id,x),children:[e("span",{children:x.productName}),t("span",{className:"text-xs",children:["â‚¹",x.productPrice]})]},x.productid))})]}),e("td",{className:"p-3",children:e("input",{type:"number",className:"w-full p-2 text-center border border-gray-200 rounded",value:m.qty,onChange:x=>S(m.id,"qty",parseInt(x.target.value)||0)})}),e("td",{className:"p-3",children:e("input",{type:"number",className:"w-full p-2 text-right border border-gray-200 rounded font-mono",value:m.price,onChange:x=>S(m.id,"price",parseFloat(x.target.value)||0)})}),t("td",{className:"p-3 text-right font-bold text-gray-700 font-mono",children:["â‚¹",m.total]}),e("td",{className:"p-3 text-center",children:e("button",{onClick:()=>q(m.id),className:"text-gray-400 hover:text-red-600 transition p-2",children:e(me,{})})})]},m.id))})]})}),t("button",{onClick:T,disabled:se,className:`flex items-center gap-2 font-bold transition mb-12 group p-2 mt-5 ${se?"text-gray-400 cursor-not-allowed":"primary-button hover:shadow-lg"}`,children:[e(pe,{size:12,className:"text-white"})," Add New Product"]}),t("div",{className:"flex flex-col md:flex-row justify-between items-start gap-8 border-t pt-8",children:[t("div",{className:"w-full md:w-1/4",children:[e("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-2",children:"Advance Amount"}),e("input",{type:"number",min:0,max:M,value:s,onChange:m=>{const x=parseFloat(m.target.value)||0;x>M?j("Advance cannot exceed total"):g(x)},className:"w-full input p-2",placeholder:"Enter advance amount"})]}),t("div",{className:"w-full md:w-1/3 space-y-4",children:[t("div",{className:"flex justify-between text-gray-600",children:[e("span",{children:"Subtotal"}),t("span",{className:"font-mono",children:["â‚¹",P.toLocaleString()]})]}),t("div",{className:"flex justify-between text-gray-600",children:[e("span",{children:"GST (18%)"}),t("span",{className:"font-mono",children:["â‚¹",k.toLocaleString()]})]}),t("div",{className:"flex justify-between text-gray-600",children:[e("span",{children:"Advance Paid"}),t("span",{className:"font-mono",children:["â‚¹",s.toLocaleString()]})]}),t("div",{className:"flex justify-between text-2xl font-black text-green-900 border-t border-green-200 pt-4",children:[e("span",{children:"Balance Due"}),t("span",{children:["â‚¹",N.toLocaleString()]})]}),t("div",{className:"flex items-center gap-2 mt-2",children:[e("input",{type:"checkbox",id:"confirmSend",checked:I,onChange:m=>D(m.target.checked),className:"w-4 h-4 accent-green-600"}),e("label",{htmlFor:"confirmSend",className:"text-sm text-gray-700",children:"I confirm the order details and want to send via WhatsApp"})]}),t("button",{onClick:ye,disabled:!I||h.length===0,className:`w-full bg-green-700 text-white py-4 rounded-xl font-bold flex items-center justify-center gap-3 
        hover:bg-green-800 transition shadow-xl mt-4 ${I?"":"opacity-60 cursor-not-allowed"}`,children:[e(he,{})," Confirm & Submit"]})]})]})]})}function ht(){return e("div",{className:"p-6 bg-gray-50 min-h-screen",children:e("h1",{className:"text-2xl font-bold mb-4",children:"Welcome to Sales Invoice"})})}function gt(){return t(Ge,{children:[e(Pe,{children:t(R,{path:"/",element:e(Xe,{}),children:[e(R,{index:!0,element:e(He,{})}),e(R,{path:"sales/pos",element:e(et,{})}),e(R,{path:"master/itemMaster",element:e(lt,{})}),e(R,{path:"sales/order",element:e(pt,{})}),e(R,{path:"sales/invoice",element:e(ht,{})}),e(R,{path:"purchase/order",element:e(tt,{})}),e(R,{path:"inventory/update",element:e(at,{})}),e(R,{path:"master/customerMaster",element:e(ut,{})}),e(R,{path:"master/categoryMaster",element:e(mt,{})})]})}),e(je,{})]})}function Ft(l){return{html:Ce(e(Ie,{location:l,children:e(gt,{})}))}}export{Ft as render};
