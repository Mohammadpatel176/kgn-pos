import X from"preact-render-to-string";import{StaticRouter as _}from"react-router-dom/server.mjs";import{Link as M,Outlet as z,Routes as B,Route as C}from"react-router-dom";import{useState as h,useRef as K,useEffect as H}from"preact/compat";import{FaCogs as W,FaUserShield as J,FaShoppingCart as Y,FaBox as U,FaFileInvoice as Q,FaWarehouse as Z,FaBoxOpen as ee,FaFileExcel as te,FaFilePdf as re,FaTrash as oe,FaPlus as ae,FaSave as le,FaCalendarAlt as ne,FaChevronLeft as ce,FaChevronRight as de}from"react-icons/fa";import{jsxs as t,jsx as e}from"preact/jsx-runtime";import j from"jspdf";import $ from"jspdf-autotable";import O from"moment";import*as R from"xlsx";function ie(){const[a,n]=h(!1);return t("aside",{onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),className:`bg-green-600 text-white h-full transition-all duration-300
        ${a?"w-64":"w-16"}`,children:[t("div",{className:"flex items-center gap-3 p-2 bg-green-700",children:[t(M,{to:"/",children:[" ",e("img",{src:"/KGNNewLOGO.png",alt:"Company Logo",className:"w-10 h-10 rounded-full object-contain"})]}),a&&e("span",{className:"font-semibold whitespace-nowrap",children:"KGN Auto Parts"})]}),t("nav",{className:"mt-4 space-y-2",children:[t(A,{open:a,icon:e(W,{}),title:"Master",children:[e(F,{to:"/master/general",children:"General Master"}),e(F,{to:"/master/other",children:"Other Masters"})]}),e(se,{open:a,icon:e(J,{}),title:"Administrator"}),t(A,{open:a,icon:e(Y,{}),title:"Sales",children:[e(F,{to:"/sales/order",children:"Sales Order"}),e(F,{to:"/sales/invoice",children:"Sales Invoice"}),e(F,{to:"/sales/open-orders",children:"Open Order List"}),e(F,{to:"/sales/pos",children:"POS"})]}),e(A,{open:a,icon:e(U,{}),title:"Purchase",children:e(F,{to:"/purchase/order",children:"Purchase Order"})}),e(A,{open:a,icon:e(U,{}),title:"Inventory",children:e(F,{to:"/inventory/update",children:"Inventory Update"})})]})]})}function se({icon:a,title:n,open:l}){return t("div",{className:"flex items-center gap-4 px-5 py-3 hover:bg-green-700 cursor-pointer",children:[a,l&&e("span",{children:n})]})}function A({icon:a,title:n,open:l,children:i}){return t("div",{children:[t("div",{className:"flex items-center gap-4 px-5 py-3 hover:bg-green-700 cursor-pointer",children:[a,l&&e("span",{children:n})]}),l&&e("div",{className:"ml-12 text-sm text-gray-200 space-y-1",children:i})]})}function F({to:a,children:n}){return e(M,{to:a,className:"block py-1 hover:text-black transition",children:n})}function pe(){const[a,n]=h(!1);return t("header",{className:"h-14 bg-green-700 border-b flex justify-between items-center px-6",children:[e("h1",{className:"text-lg font-semibold text-gray-800",children:"Dashboard"}),t("div",{className:"relative",children:[e("img",{src:"https://i.pravatar.cc/40",alt:"user",onClick:()=>n(!a),className:"w-9 h-9 rounded-full cursor-pointer border"}),a&&t("div",{className:"absolute right-0 mt-2 w-40 bg-white shadow-lg rounded-md",children:[e("button",{className:"block w-full px-4 py-2 text-left hover:bg-gray-100",children:"My Profile"}),e("button",{className:"block w-full px-4 py-2 text-left text-red-600 hover:bg-gray-100",children:"Logout"})]})]})]})}function ue(){return t("div",{className:"flex h-screen bg-gray-100",children:[e(ie,{}),t("div",{className:"flex flex-col flex-1",children:[e(pe,{}),e("main",{className:"p-4 overflow-y-auto",children:e(z,{})})]})]})}function me(){return t("div",{className:"space-y-6",children:[t("div",{children:[e("h1",{className:"text-2xl font-semibold text-gray-800",children:"Dashboard"}),e("p",{className:"text-sm text-gray-500",children:"Overview of your business activities"})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6",children:[e(L,{title:"Today's Sales",value:"â‚¹ 1,25,000",icon:e(Y,{}),color:"bg-green-600"}),e(L,{title:"Invoices",value:"145",icon:e(Q,{}),color:"bg-black"}),e(L,{title:"Inventory Stock",value:"8,540",icon:e(Z,{}),color:"bg-green-700"}),e(L,{title:"Pending Orders",value:"23",icon:e(ee,{}),color:"bg-black"})]}),t("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[t("div",{className:"xl:col-span-2 bg-white rounded-lg shadow p-5",children:[e("h2",{className:"font-semibold text-gray-700 mb-4",children:"Sales Summary"}),e("div",{className:"h-56 flex items-center justify-center text-gray-400",children:"ðŸ“Š Chart placeholder (connect Recharts / Chart.js)"})]}),t("div",{className:"bg-white rounded-lg shadow p-5 space-y-4",children:[e("h2",{className:"font-semibold text-gray-700",children:"Quick Stats"}),e(E,{label:"Today's Orders",value:"32"}),e(E,{label:"Purchase Orders",value:"18"}),e(E,{label:"Low Stock Items",value:"7",danger:!0}),e(E,{label:"Returns",value:"3"})]})]}),t("div",{className:"bg-white rounded-lg shadow p-5",children:[e("h2",{className:"font-semibold text-gray-700 mb-4",children:"Recent Transactions"}),e("div",{className:"overflow-x-auto",children:t("table",{className:"w-full text-sm",children:[e("thead",{className:"bg-gray-100 text-gray-600",children:t("tr",{children:[e("th",{className:"p-3 text-left",children:"Invoice No"}),e("th",{className:"p-3 text-left",children:"Customer"}),e("th",{className:"p-3 text-left",children:"Date"}),e("th",{className:"p-3 text-right",children:"Amount"}),e("th",{className:"p-3 text-center",children:"Status"})]})}),t("tbody",{children:[e(k,{invoice:"INV-1001",customer:"ABC Traders",date:"02 Jan 2026",amount:"â‚¹ 12,500",status:"Paid"}),e(k,{invoice:"INV-1002",customer:"XYZ Enterprises",date:"02 Jan 2026",amount:"â‚¹ 8,200",status:"Pending"}),e(k,{invoice:"INV-1003",customer:"Global Stores",date:"01 Jan 2026",amount:"â‚¹ 15,900",status:"Paid"})]})]})})]})]})}function L({title:a,value:n,icon:l,color:i}){return t("div",{className:"bg-white rounded-lg shadow p-5 flex justify-between items-center",children:[t("div",{children:[e("p",{className:"text-sm text-gray-500",children:a}),e("h3",{className:"text-xl font-bold text-gray-800",children:n})]}),e("div",{className:`w-12 h-12 rounded-full text-white flex items-center justify-center ${i}`,children:l})]})}function E({label:a,value:n,danger:l}){return t("div",{className:"flex justify-between text-sm",children:[e("span",{className:"text-gray-600",children:a}),e("span",{className:`font-semibold ${l?"text-red-600":"text-gray-800"}`,children:n})]})}function k({invoice:a,customer:n,date:l,amount:i,status:p}){const r=p==="Paid";return t("tr",{className:"border-b last:border-0",children:[e("td",{className:"p-3",children:a}),e("td",{className:"p-3",children:n}),e("td",{className:"p-3",children:l}),e("td",{className:"p-3 text-right",children:i}),e("td",{className:"p-3 text-center",children:e("span",{className:`px-3 py-1 rounded-full text-xs font-medium
            ${r?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"}`,children:p})})]})}const q=JSON.parse('[{"productid":1,"productName":"Compact Frame","productPrice":1350,"productImageUrl":"/Images/Compect_Fram_Final.png","productDescription":"High-quality compact frame for auto rickshaws."},{"productid":2,"productName":"Back Door","productPrice":950,"productImageUrl":"/Images/Dore_Final.png","productDescription":"Durable metal back door for cargo space."},{"productid":3,"productName":"Compact Floor 18","productPrice":1200,"productImageUrl":"/Images/Flooring_14.png","productDescription":"18-gauge heavy-duty flooring sheet."},{"productid":4,"productName":"Compact Floor 14","productPrice":1350,"productImageUrl":"/Images/flooring_18.png","productDescription":"14-gauge premium flooring sheet."},{"productid":5,"productName":"Half Star","productPrice":100,"productImageUrl":"/Images/Samosa_final.png","productDescription":"Samosa style bracket support."},{"productid":6,"productName":"Alfa Floor","productPrice":1300,"productImageUrl":"/Images/side darvaja.png","productDescription":"Specialized flooring for Alfa models."},{"productid":1,"productName":"Y Support","productPrice":250,"productImageUrl":"/Images/test_new.png","productDescription":"Reinforced Y-shaped structural support."},{"productid":1,"productName":"Compact Frame","productPrice":1350,"productImageUrl":"/Images/Compect_Fram_Final.png","productDescription":"High-quality compact frame for auto rickshaws."},{"productid":2,"productName":"Back Door","productPrice":950,"productImageUrl":"/Images/Dore_Final.png","productDescription":"Durable metal back door for cargo space."},{"productid":3,"productName":"Compact Floor 18","productPrice":1200,"productImageUrl":"/Images/Flooring_14.png","productDescription":"18-gauge heavy-duty flooring sheet."},{"productid":4,"productName":"Compact Floor 14","productPrice":1350,"productImageUrl":"/Images/flooring_18.png","productDescription":"14-gauge premium flooring sheet."},{"productid":5,"productName":"Half Star","productPrice":100,"productImageUrl":"/Images/Samosa_final.png","productDescription":"Samosa style bracket support."},{"productid":6,"productName":"Alfa Floor","productPrice":1300,"productImageUrl":"/Images/side_darvaja.png","productDescription":"Specialized flooring for Alfa models."},{"productid":7,"productName":"Y Support","productPrice":250,"productImageUrl":"/Images/test_new.png","productDescription":"Reinforced Y-shaped structural support."},{"productid":8,"productName":"GLASS FRAME PASSENGER","productPrice":0,"productImageUrl":"/Images/GlassFrame_Pecenger.png","productDescription":"Glass frame for passenger auto rickshaw."},{"productid":9,"productName":"GLASS FRAME LOADING","productPrice":0,"productImageUrl":"/Images/Glass_frame_loading.png","productDescription":"Glass frame for loading auto rickshaw."},{"productid":10,"productName":"FRONT FLOORING","productPrice":0,"productImageUrl":"/Images/FrontFlooring.png","productDescription":"Front flooring sheet."},{"productid":11,"productName":"FRONT DERA","productPrice":0,"productImageUrl":"/Images/FrontDera.png","productDescription":"Front dera body component."},{"productid":12,"productName":"BODY PASSENGER OLD","productPrice":0,"productImageUrl":"/Images/BodyPacengerOld.png","productDescription":"Old model passenger body."},{"productid":13,"productName":"DELUX PASSENGER BODY","productPrice":0,"productImageUrl":"/Images/DeluxPacengerBody.png","productDescription":"Deluxe passenger body."},{"productid":14,"productName":"COMPLETE TROLLEY O/M","productPrice":0,"productImageUrl":"/Images/CompleteTrolyOM.png","productDescription":"Complete trolley old model."},{"productid":15,"productName":"X.L.D TROLLEY GREEN","productPrice":0,"productImageUrl":"/Images/XLDTrollyGreen.png","productDescription":"XLD trolley painted green."},{"productid":16,"productName":"X.L.D TROLLEY YELLOW","productPrice":0,"productImageUrl":"/Images/XLDTrollyYellow.png","productDescription":"XLD trolley painted yellow."},{"productid":17,"productName":"X.L.D TROLLEY RED","productPrice":0,"productImageUrl":"/Images/XLDTrollyRed.png","productDescription":"XLD trolley painted red."},{"productid":18,"productName":"TROLLEY X.L.D N/M","productPrice":0,"productImageUrl":"/Images/XLDTrollyXM.png","productDescription":"XLD trolley new model."},{"productid":19,"productName":"CITY GLASS FRAME","productPrice":0,"productImageUrl":"/Images/ApeCityGlassFrame.png","productDescription":"City model glass frame."},{"productid":20,"productName":"TROLLEY FLOORING WITH CHANNEL","productPrice":0,"productImageUrl":"/Images/TrollyFlooringWithChenal.png","productDescription":"Trolley flooring with support channel."},{"productid":21,"productName":"TROLLEY FLOORING","productPrice":0,"productImageUrl":"/Images/TrollyFlooring.png","productDescription":"Standard trolley flooring."},{"productid":22,"productName":"LD TROLLEY FLOORING","productPrice":0,"productImageUrl":"/Images/LDTrollyFlooring.png","productDescription":"Loading trolley flooring."},{"productid":23,"productName":"PASSENGER CENTER FLOORING","productPrice":0,"productImageUrl":"/Images/PessCenterFlooring.png","productDescription":"Passenger center flooring."},{"productid":24,"productName":"ENGINE BONNET","productPrice":0,"productImageUrl":"/Images/EngenBonnat.png","productDescription":"Engine bonnet cover."},{"productid":25,"productName":"REAR TAILGATE PASSENGER","productPrice":0,"productImageUrl":"/Images/RtelgetPec.png","productDescription":"Passenger rear tailgate."},{"productid":26,"productName":"DRIVER PARTITION (TAKA)","productPrice":0,"productImageUrl":"/Images/DrivPartation.png","productDescription":"Driver partition panel."},{"productid":27,"productName":"FRONT FALKA LOADING","productPrice":0,"productImageUrl":"/Images/FrntFalkaLod.png","productDescription":"Front falka for loading body."},{"productid":28,"productName":"SIDE FALKA LOADING","productPrice":0,"productImageUrl":"/Images/SideFalkaLod.png","productDescription":"Side falka for loading body."},{"productid":29,"productName":"SIDE PANEL PASSENGER","productPrice":0,"productImageUrl":"/Images/SidePanelPecg.png","productDescription":"Passenger side panel."},{"productid":30,"productName":"TOP","productPrice":0,"productImageUrl":"/Images/Top.png","productDescription":"Vehicle top body part."},{"productid":31,"productName":"DIESEL TANK PATARA","productPrice":0,"productImageUrl":"/Images/DesialTankPatra.png","productDescription":"Diesel tank protection patara."},{"productid":32,"productName":"FRONT CONA BIG PASSENGER","productPrice":0,"productImageUrl":"/Images/FrontConeBigPecg.png","productDescription":"Front big cona passenger."},{"productid":33,"productName":"REAR CONA SMALL PASSENGER","productPrice":0,"productImageUrl":"/Images/RearConeSmallPecg.png","productDescription":"Rear small cona passenger."},{"productid":34,"productName":"FOOT REST","productPrice":0,"productImageUrl":"/Images/FootRest.png","productDescription":"Foot rest support."},{"productid":35,"productName":"TEKA","productPrice":0,"productImageUrl":"/Images/Teka.png","productDescription":"Structural teka support."},{"productid":36,"productName":"COMPLETE DOOR","productPrice":0,"productImageUrl":"/Images/CompectDore.png","productDescription":"Complete side door."},{"productid":37,"productName":"FRONT MUDGUARD","productPrice":0,"productImageUrl":"/Images/FrontMudgart.png","productDescription":"Front mudguard."},{"productid":38,"productName":"FRONT FLOORING CORNER SAMOSA","productPrice":0,"productImageUrl":"/Images/FrontFloringRearCorner.png","productDescription":"Front flooring corner samosa."},{"productid":39,"productName":"FRONT FLOORING REAR CONA","productPrice":0,"productImageUrl":"/Images/FrontFloringRearCorner.png","productDescription":"Front flooring rear cona."},{"productid":40,"productName":"TEKA PILLAR","productPrice":0,"productImageUrl":"/Images/TekaPiller.png","productDescription":"Teka pillar support."},{"productid":41,"productName":"DERA SUPPORT","productPrice":0,"productImageUrl":"/Images/DearSupport.png","productDescription":"Dera body support."},{"productid":42,"productName":"MIRROR CLAMP","productPrice":0,"productImageUrl":"/Images/MirrorClamp.png","productDescription":"Mirror clamp holder."},{"productid":43,"productName":"SIDE MUDGUARD","productPrice":0,"productImageUrl":"/Images/SideMudgard.png","productDescription":"Side mudguard."},{"productid":44,"productName":"HOOD PIPE","productPrice":0,"productImageUrl":"/Images/HoodPipe.png","productDescription":"Hood pipe support."},{"productid":45,"productName":"REAR GUARD","productPrice":0,"productImageUrl":"/Images/RearGuard.png","productDescription":"Rear safety guard."}]');function ge({name:a,price:n,image:l,onAdd:i}){return t("div",{className:"group bg-white w-full rounded-xl p-4 shadow-sm hover:shadow-md border border-gray-200 transition-all",children:[e("div",{className:"h-32 w-full overflow-hidden rounded-lg bg-gray-50",children:e("img",{src:l,alt:a,className:"w-full h-full object-contain group-hover:scale-110 transition-transform"})}),e("h3",{className:"mt-3 font-semibold text-sm h-10 overflow-hidden",children:a}),t("p",{className:"text-lg font-bold text-gray-900",children:["â‚¹",n]}),e("button",{onClick:i,className:"w-full mt-3 bg-green-600 text-white py-2 rounded-lg text-sm font-bold hover:bg-black transition-colors",children:"+ Add to Bill"})]})}const he=({isOpen:a,onClose:n,formData:l,setFormData:i,onConfirm:p})=>{if(!a)return null;const r=b=>{const{name:x,value:N,type:g,checked:m}=b.target;i(u=>({...u,[x]:g==="checkbox"?m:N}))};return e("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[100] p-4",children:t("div",{className:"bg-white rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto shadow-2xl",children:[t("div",{className:"p-6 border-b flex justify-between items-center bg-green-700 text-white sticky top-0 z-10",children:[t("div",{children:[e("h2",{className:"text-xl font-bold uppercase tracking-wide",children:"Customer Billing Details"}),e("p",{className:"text-xs text-green-100",children:"KGN Motors Official POS"})]}),e("button",{onClick:n,className:"text-3xl hover:text-gray-200",children:"Ã—"})]}),t("form",{className:"p-6 space-y-6",onSubmit:p,children:[t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Customer / Party Name *"}),e("input",{name:"customerName",type:"text",required:!0,value:l.customerName,onChange:r,className:"w-full border-2 border-gray-200 p-2 rounded-lg focus:border-green-600 outline-none",placeholder:"Full Name"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Phone Number *"}),e("input",{name:"customerPhone",type:"tel",required:!0,value:l.customerPhone,onChange:r,className:"w-full border-2 border-gray-200 p-2 rounded-lg focus:border-green-600 outline-none",placeholder:"Contact No."})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t("div",{children:[e("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Supplier Name"}),e("input",{name:"supplierName",type:"text",value:l.supplierName,onChange:r,className:"w-full border border-gray-200 p-2 rounded-lg",placeholder:"Optional"})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"GST Number"}),e("input",{name:"gstNumber",type:"text",value:l.gstNumber,onChange:r,className:"w-full border border-gray-200 p-2 rounded-lg",placeholder:"22AAAAA0000A1Z5"})]})]}),t("div",{className:"flex items-center gap-3 bg-gray-50 p-4 rounded-xl border-2 border-dashed border-gray-200",children:[e("input",{name:"isVehicle",type:"checkbox",id:"vehicle",checked:l.isVehicle,onChange:r,className:"w-6 h-6 accent-green-700 cursor-pointer"}),e("label",{htmlFor:"vehicle",className:"font-bold text-gray-700 cursor-pointer",children:"Include Vehicle & Driver Details?"})]}),l.isVehicle&&t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 p-4 bg-green-50 rounded-xl border border-green-200 transition-all",children:[t("div",{children:[e("label",{className:"block text-xs font-bold text-green-800 mb-1",children:"Driver Name *"}),e("input",{name:"driverName",type:"text",required:l.isVehicle,value:l.driverName,onChange:r,className:"w-full border border-green-300 p-2 rounded-lg bg-white"})]}),t("div",{children:[e("label",{className:"block text-xs font-bold text-green-800 mb-1",children:"Vehicle No. *"}),e("input",{name:"vehicleNumber",type:"text",required:l.isVehicle,value:l.vehicleNumber,onChange:r,className:"w-full border border-green-300 p-2 rounded-lg bg-white",placeholder:"GJ-XX-0000"})]}),t("div",{children:[e("label",{className:"block text-xs font-bold text-green-800 mb-1",children:"Driver Phone *"}),e("input",{name:"driverPhone",type:"tel",required:l.isVehicle,value:l.driverPhone,onChange:r,className:"w-full border border-green-300 p-2 rounded-lg bg-white"})]})]}),t("div",{children:[e("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Additional Business Details"}),e("textarea",{name:"businessDetails",value:l.businessDetails,onChange:r,className:"w-full border border-gray-200 p-2 rounded-lg",rows:"2",placeholder:"Address or special notes..."})]}),t("div",{className:"flex gap-4 pt-4 sticky bottom-0 bg-white",children:[e("button",{type:"button",onClick:n,className:"flex-1 px-6 py-3 rounded-xl font-bold border-2 border-gray-200 hover:bg-gray-50 transition-all",children:"Cancel"}),e("button",{type:"submit",className:"flex-1 bg-green-700 text-white px-6 py-3 rounded-xl font-bold hover:bg-black transition-all shadow-lg",children:"Confirm & Generate Bill"})]})]})]})})},be=a=>new Promise((n,l)=>{const i=new Image;i.src=a,i.onload=()=>n(i),i.onerror=p=>l(p)}),Ne=async(a,n,l,i,p)=>{const r=new j("p","mm","a4"),b=(i/2).toFixed(2),x="/KGNNewLOGO.png";try{const N=await be(x);r.saveGraphicsState(),r.setGState(new r.GState({opacity:.05})),r.addImage(N,"PNG",55,100,100,100),r.restoreGraphicsState(),r.addImage(N,"PNG",14,10,22,22),r.setTextColor(0,100,0),r.setFontSize(22),r.setFont("helvetica","bold"),r.text("KGN MOTORS",40,18),r.setFontSize(8),r.setFont("helvetica","normal"),r.setTextColor(60),r.text("Shop No. 12, Auto Plaza, Near Railway Crossing,",40,23),r.text("Sarkhej Road, Juhapura, Ahmedabad - 380055",40,27),r.text("GSTIN: 24ABCCE1234F1Z5 | State: Gujarat (24)",40,31),r.text("Email: kgnmotors.abd@gmail.com | Mob: +91 99721 XXXXX",40,35),r.setTextColor(0),r.setFontSize(14),r.text("TAX INVOICE",150,18),r.setFontSize(9);const g=`KGN/25-26/${Math.floor(1e3+Math.random()*9e3)}`;r.text(`Invoice No: ${g}`,150,24),r.text(`Date: ${new Date().toLocaleDateString("en-IN")}`,150,29),r.setDrawColor(0,100,0),r.setLineWidth(.5),r.line(14,38,196,38),r.setFont("helvetica","bold"),r.text("BILL TO:",14,46),r.setFont("helvetica","normal"),r.text(`${a.customerName.toUpperCase()}`,14,51),r.text(`Phone: +91 ${a.customerPhone}`,14,56),a.isVehicle&&(r.setFont("helvetica","bold"),r.text("VEHICLE:",120,46),r.setFont("helvetica","normal"),r.text(`No: ${a.vehicleNumber.toUpperCase()}`,120,51),r.text(`Driver: ${a.driverName}`,120,56)),$(r,{startY:65,head:[["SR.","ITEM DESCRIPTION","QTY","RATE","CGST(9%)","SGST(9%)","AMOUNT"]],body:n.map((P,o)=>{const d=P.productPrice*P.quantity,s=(d*.09).toFixed(2);return[o+1,P.productName.toUpperCase(),P.quantity,P.productPrice.toFixed(2),s,s,(d+parseFloat(s)*2).toFixed(2)]}),theme:"grid",styles:{fontSize:8,cellPadding:3,textColor:[0,0,0]},headStyles:{fillColor:[0,100,0],halign:"center"},columnStyles:{0:{halign:"center",cellWidth:10},1:{cellWidth:55},2:{halign:"center"},3:{halign:"right"},4:{halign:"right"},5:{halign:"right"},6:{halign:"right",fontStyle:"bold"}}});let m=r.lastAutoTable.finalY+10;const u=140,f=196;r.setFontSize(10),r.text("Taxable Value:",u,m),r.text(`${l.toFixed(2)}`,f,m,{align:"right"}),r.text("Total CGST:",u,m+5),r.text(`${b}`,f,m+5,{align:"right"}),r.text("Total SGST:",u,m+10),r.text(`${b}`,f,m+10,{align:"right"}),r.setLineDash([1,1],0),r.line(u,m+13,196,m+13),r.setFont(void 0,"bold"),r.setFontSize(12),r.text("GRAND TOTAL:",u,m+20),r.text(`Rs. ${p.toFixed(2)}`,f,m+20,{align:"right"});const S=270;r.setFontSize(9),r.text("For, KGN MOTORS",150,S-15),r.setLineDash([1,1],0),r.rect(148,S-13,45,15),r.text("Authorised Signatory",153,S+6),window.open(r.output("bloburl"),"_blank"),r.save(`KGN_INV_${Date.now()}.pdf`)}catch(N){console.error("PDF Generation failed",N)}};function xe(){const[a]=h(q),[n,l]=h([]),[i,p]=h(!1),[r,b]=h(""),[x,N]=h("amount"),[g,m]=h(0),[u,f]=h({customerName:"",customerPhone:"",isVehicle:!1,driverName:"",vehicleNumber:"",driverPhone:""}),S=a.filter(c=>c.productName.toLowerCase().includes(r.toLowerCase())),P=c=>{l(v=>v.find(I=>I.productid===c.productid)?v.map(I=>I.productid===c.productid?{...I,quantity:I.quantity+1}:I):[...v,{...c,quantity:1}])},o=(c,v)=>{l(G=>G.map(I=>I.productid===c&&I.quantity+v>0?{...I,quantity:I.quantity+v}:I))},d=c=>l(n.filter(v=>v.productid!==c)),s=n.reduce((c,v)=>c+v.productPrice*v.quantity,0),w=x==="percent"?s*g/100:g,D=Math.max(s-w,0),y=D*.18,T=D+y,V=async c=>{c.preventDefault(),await Ne(u,n,s,w,y),l([]),m(0),p(!1)};return t("div",{className:"flex w-full h-full bg-gray-100 overflow-hidden",children:[t("div",{className:"flex-1 p-6 overflow-y-auto",children:[e("h1",{className:"text-3xl font-black text-green-700 mb-2",children:"KGN MOTORS"}),e("input",{className:"w-full mb-4 px-4 py-2 border rounded-lg",placeholder:"Search auto parts...",value:r,onChange:c=>b(c.target.value)}),e("div",{className:"grid grid-cols-2 md:grid-cols-4 xl:grid-cols-5 gap-4",children:S.map(c=>e(ge,{name:c.productName,price:c.productPrice,image:c.productImageUrl,onAdd:()=>P(c)},c.productid))})]}),t("div",{className:"w-[380px] bg-white shadow-xl flex flex-col",children:[t("div",{className:"bg-green-700 text-white p-4 font-bold",children:["CART (",n.reduce((c,v)=>c+v.quantity,0),")"]}),e("div",{className:"flex-1 p-4 space-y-3 overflow-y-auto bg-gray-50",children:n.map(c=>t("div",{className:"bg-white p-3 rounded border",children:[t("div",{className:"flex justify-between",children:[e("span",{className:"font-bold text-xs",children:c.productName}),e("button",{onClick:()=>d(c.productid),className:"text-red-500",children:"âœ•"})]}),t("div",{className:"flex justify-between mt-2 items-center",children:[t("div",{className:"flex gap-3",children:[e("button",{onClick:()=>o(c.productid,-1),children:"-"}),e("span",{children:c.quantity}),e("button",{onClick:()=>o(c.productid,1),children:"+"})]}),t("span",{className:"font-bold",children:["â‚¹",c.productPrice*c.quantity]})]})]},c.productid))}),t("div",{className:"p-4 border-t space-y-2",children:[t("div",{className:"flex justify-between",children:[e("span",{children:"Subtotal"}),t("span",{children:["â‚¹",s.toFixed(2)]})]}),t("div",{className:"flex gap-2",children:[t("select",{className:"border px-2",value:x,onChange:c=>N(c.target.value),children:[e("option",{value:"amount",children:"â‚¹"}),e("option",{value:"percent",children:"%"})]}),e("input",{type:"number",className:"border flex-1 px-2",placeholder:"Discount",value:g,onChange:c=>m(+c.target.value)})]}),t("div",{className:"flex justify-between text-red-600 font-bold",children:[e("span",{children:"Discount"}),t("span",{children:["-â‚¹",w.toFixed(2)]})]}),t("div",{className:"flex justify-between",children:[e("span",{children:"GST (18%)"}),t("span",{children:["â‚¹",y.toFixed(2)]})]}),t("div",{className:"flex justify-between text-xl font-black",children:[e("span",{children:"TOTAL"}),t("span",{className:"text-green-700",children:["â‚¹",T.toFixed(2)]})]}),e("button",{onClick:()=>p(!0),disabled:!n.length,className:"w-full mt-4 bg-green-700 text-white py-3 rounded-lg font-bold",children:"PRINT INVOICE"})]})]}),e(he,{isOpen:i,onClose:()=>p(!1),formData:u,setFormData:f,onConfirm:V})]})}function fe({selectedDate:a,onDateChange:n}){const[l,i]=h(!1),[p,r]=h(O()),[b,x]=h([]),N=K(null);return H(()=>{const g=O(p).startOf("month").startOf("week"),m=O(p).endOf("month").endOf("week"),u=g.clone().subtract(1,"day"),f=[];for(;u.isBefore(m,"day");)f.push(Array(7).fill(0).map(()=>u.add(1,"day").clone()));x(f)},[p]),t("div",{className:"relative w-full",ref:N,children:[e("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-1",children:"Delivery Date"}),t("div",{onClick:()=>i(!l),className:"flex items-center justify-between w-full border border-gray-300 rounded-lg p-3 bg-white cursor-pointer hover:border-green-500 transition-all focus-within:ring-2 focus-within:ring-green-200",children:[e("span",{className:"text-gray-800",children:O(a).format("DD MMM, YYYY")}),e(ne,{className:"text-green-600"})]}),l&&t("div",{className:"absolute z-[100] mt-2 left-0 w-72 bg-white shadow-2xl rounded-xl border border-gray-100 p-4 animate-in fade-in zoom-in duration-200",children:[t("div",{className:"flex justify-between items-center mb-4",children:[e("button",{onClick:()=>r(p.clone().subtract(1,"month")),className:"p-1 hover:bg-green-50 rounded text-green-700",children:e(ce,{})}),e("h3",{className:"font-bold text-gray-800 text-sm",children:p.format("MMMM YYYY")}),e("button",{onClick:()=>r(p.clone().add(1,"month")),className:"p-1 hover:bg-green-50 rounded text-green-700",children:e(de,{})})]}),e("div",{className:"grid grid-cols-7 mb-2 text-center text-[10px] font-bold text-gray-400 uppercase",children:["Su","Mo","Tu","We","Th","Fr","Sa"].map(g=>e("div",{children:g},g))}),e("div",{className:"space-y-1",children:b.map((g,m)=>e("div",{className:"grid grid-cols-7",children:g.map((u,f)=>{const S=u.format("YYYY-MM-DD")===a,P=u.isSame(p,"month");return e("button",{onClick:()=>{n(u.format("YYYY-MM-DD")),i(!1)},className:`h-8 w-8 mx-auto flex items-center justify-center rounded-lg text-xs transition-all
                        ${P?"text-gray-700 hover:bg-green-100":"text-gray-200"}
                        ${S?"bg-green-600 text-white shadow-md scale-110":""}
                      `,children:u.date()},f)})},m))})]})]})}function ye(){const[a,n]=h({name:"",date:O().format("YYYY-MM-DD"),poNumber:`PO-${Math.floor(1e3+Math.random()*9e3)}`}),[l,i]=h([{id:1,name:"",qty:1,price:0,total:0}]),[p,r]=h({rowId:null,results:[]}),b=l.reduce((o,d)=>o+d.qty*d.price,0),x=b*.18,N=b+x,g=()=>i([...l,{id:Date.now(),name:"",qty:1,price:0,total:0}]),m=o=>l.length>1&&i(l.filter(d=>d.id!==o)),u=(o,d,s)=>{const w=l.map(D=>{if(D.id===o){const y={...D,[d]:s};return y.total=y.qty*y.price,y}return D});if(i(w),d==="name")if(s.length>1){const D=q.filter(y=>y.productName.toLowerCase().includes(s.toLowerCase()));r({rowId:o,results:D})}else r({rowId:null,results:[]})},f=(o,d)=>{i(l.map(s=>s.id===o?{...s,name:d.productName,price:d.productPrice,total:s.qty*d.productPrice}:s)),r({rowId:null,results:[]})},S=()=>{const o=[["KGN AUTO PARTS - PURCHASE ORDER"],[`PO Number: ${a.poNumber}`],[`Vendor: ${a.name||"N/A"}`],[`Date: ${a.date}`],[""],["Product Description","Quantity","Unit Price (INR)","Total (INR)"]],d=l.map(T=>[T.name,T.qty,T.price,T.total]),s=[["","","Subtotal",b],["","","GST (18%)",x],["","","Grand Total",N]],w=[...o,...d,[""],...s],D=R.utils.aoa_to_sheet(w),y=R.utils.book_new();R.utils.book_append_sheet(y,D,"Purchase Order"),R.writeFile(y,`${a.poNumber}.xlsx`)},P=()=>{const o=new j,d=[22,163,74];o.setFillColor(...d),o.rect(0,0,210,25,"F"),o.setTextColor(255,255,255),o.setFontSize(14),o.text("KGN AUTO PARTS",14,12),o.setFontSize(8),o.text("Purchase Order Document",14,18),o.setFontSize(12),o.text("PURCHASE ORDER",150,15),o.setTextColor(40,40,40),o.setFontSize(9),o.setFont(void 0,"bold"),o.text("BILL TO:",14,35),o.setFont(void 0,"normal"),o.text("KGN Auto Parts, Ahmedabad, GJ",14,40),o.setFont(void 0,"bold"),o.text("ORDER DETAILS:",130,35),o.setFont(void 0,"normal"),o.text(`Vendor: ${a.name||"N/A"}`,130,40),o.text(`PO Number: ${a.poNumber}`,130,45),o.text(`Date: ${a.date}`,130,50),$(o,{startY:55,head:[["Description","Qty","Price","Total"]],body:l.map(w=>[w.name,w.qty,w.price.toFixed(2),w.total.toFixed(2)]),theme:"grid",styles:{fontSize:8,cellPadding:2},headStyles:{fillColor:d,textColor:[255,255,255],halign:"center"},columnStyles:{1:{halign:"center"},2:{halign:"right"},3:{halign:"right"}}});const s=o.lastAutoTable.finalY+10;o.setFontSize(9),o.text("Subtotal:",140,s),o.text(`Rs. ${b.toFixed(2)}`,185,s,{align:"right"}),o.text("GST (18%):",140,s+5),o.text(`Rs. ${x.toFixed(2)}`,185,s+5,{align:"right"}),o.setFont(void 0,"bold"),o.setTextColor(...d),o.text("GRAND TOTAL:",140,s+12),o.text(`Rs. ${N.toFixed(2)}`,185,s+12,{align:"right"}),o.save(`${a.poNumber}.pdf`)};return e("div",{className:"p-3 bg-gray-50 min-h-screen",children:t("div",{className:"mx-auto bg-white rounded-xl shadow-lg border border-gray-200 p-8",children:[t("div",{className:"flex flex-col md:flex-row justify-between items-center mb-8 border-b pb-6 gap-4",children:[e("div",{children:e("h1",{className:"text-3xl font-extrabold text-gray-900 tracking-tight",children:"Purchase Order"})}),t("div",{className:"flex gap-3",children:[t("button",{onClick:S,className:"flex items-center gap-2 bg-emerald-600 text-white px-5 py-2.5 rounded-lg hover:bg-emerald-700 transition font-semibold shadow-md",children:[e(te,{})," Excel"]}),t("button",{onClick:P,className:"flex items-center gap-2 bg-rose-600 text-white px-5 py-2.5 rounded-lg hover:bg-rose-700 transition font-semibold shadow-md",children:[e(re,{})," PDF"]})]})]}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-10",children:[t("div",{className:"space-y-1",children:[e("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Vendor Name"}),e("input",{type:"text",className:"w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-green-500 outline-none",placeholder:"Supplier name...",value:a.name,onChange:o=>n({...a,name:o.target.value})})]}),t("div",{className:"space-y-1",children:[e("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"PO Number"}),e("input",{type:"text",readOnly:!0,className:"w-full bg-gray-100 border border-gray-300 rounded-lg p-3 text-gray-600 font-mono",value:a.poNumber})]}),e("div",{className:"space-y-1",children:e(fe,{selectedDate:a.date,onDateChange:o=>n({...a,date:o})})})]}),e("div",{className:"overflow-visible mb-6",children:t("table",{className:"w-full border-collapse",children:[e("thead",{children:t("tr",{className:"bg-green-700 text-white",children:[e("th",{className:"p-4 text-left rounded-tl-lg font-semibold",children:"Product Description"}),e("th",{className:"p-4 text-center font-semibold w-28",children:"Qty"}),e("th",{className:"p-4 text-right font-semibold w-44",children:"Unit Price (â‚¹)"}),e("th",{className:"p-4 text-right font-semibold w-44",children:"Total (â‚¹)"}),e("th",{className:"p-4 text-center rounded-tr-lg w-16"})]})}),e("tbody",{className:"divide-y divide-gray-200",children:l.map(o=>t("tr",{className:"hover:bg-green-50/30 transition",children:[t("td",{className:"p-3 relative",children:[e("input",{autoComplete:"off",type:"text",className:"w-full p-2 border border-transparent focus:border-green-500 focus:bg-white rounded outline-none",placeholder:"Search items...",value:o.name,onChange:d=>u(o.id,"name",d.target.value)}),p.rowId===o.id&&p.results.length>0&&e("div",{className:"absolute z-50 left-2 right-2 mt-1 bg-white border border-gray-300 rounded-xl shadow-2xl max-h-56 overflow-y-auto ring-2 ring-green-500 ring-opacity-20",children:p.results.map(d=>t("div",{className:"p-3 hover:bg-green-600 hover:text-white cursor-pointer flex justify-between items-center transition",onClick:()=>f(o.id,d),children:[e("span",{className:"font-semibold",children:d.productName}),t("span",{className:"text-xs opacity-80 font-mono",children:["â‚¹",d.productPrice]})]},d.productid))})]}),e("td",{className:"p-3",children:e("input",{type:"number",className:"w-full p-2 text-center border border-gray-200 rounded",value:o.qty,onChange:d=>u(o.id,"qty",parseInt(d.target.value)||0)})}),e("td",{className:"p-3",children:e("input",{type:"number",className:"w-full p-2 text-right border border-gray-200 rounded font-mono",value:o.price,onChange:d=>u(o.id,"price",parseFloat(d.target.value)||0)})}),t("td",{className:"p-3 text-right font-bold text-gray-700 font-mono",children:["â‚¹",o.total.toLocaleString()]}),e("td",{className:"p-3 text-center",children:e("button",{onClick:()=>m(o.id),className:"text-gray-400 hover:text-red-600 transition p-2",children:e(oe,{})})})]},o.id))})]})}),t("button",{onClick:g,className:"flex items-center gap-2 text-green-700 font-bold hover:text-green-900 transition mb-12 group",children:[e("span",{className:"bg-green-100 p-1 rounded-full group-hover:bg-green-200",children:e(ae,{size:12})})," Add New Product"]}),t("div",{className:"flex flex-col md:flex-row justify-between items-start gap-8 border-t pt-8",children:[t("div",{className:"w-full md:w-1/2",children:[e("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-2",children:"Terms & Conditions"}),e("textarea",{className:"w-full border border-gray-200 rounded-lg p-3 text-sm h-24 text-gray-600 focus:ring-2 focus:ring-green-500 outline-none",placeholder:"Enter notes or terms here..."})]}),t("div",{className:"w-full md:w-1/3 bg-green-50/50 p-6 rounded-xl border border-green-100 space-y-4",children:[t("div",{className:"flex justify-between text-gray-600",children:[e("span",{children:"Subtotal"}),t("span",{className:"font-mono",children:["â‚¹",b.toLocaleString()]})]}),t("div",{className:"flex justify-between text-gray-600",children:[e("span",{children:"GST (18%)"}),t("span",{className:"font-mono",children:["â‚¹",x.toLocaleString()]})]}),t("div",{className:"flex justify-between text-2xl font-black text-green-900 border-t border-green-200 pt-4",children:[e("span",{children:"Total"}),t("span",{children:["â‚¹",N.toLocaleString()]})]}),t("button",{className:"w-full bg-green-700 text-white py-4 rounded-xl font-bold flex items-center justify-center gap-3 hover:bg-green-800 transition shadow-xl mt-4",children:[e(le,{})," Confirm & Submit"]})]})]})]})})}function ve(){return e(B,{children:t(C,{path:"/",element:e(ue,{}),children:[e(C,{index:!0,element:e(me,{})}),e(C,{path:"sales/pos",element:e(xe,{})}),e(C,{path:"sales/order",element:e("div",{children:"Sales Order"})}),e(C,{path:"sales/invoice",element:e("div",{children:"Sales Invoice"})}),e(C,{path:"purchase/order",element:e(ye,{})}),e(C,{path:"inventory/update",element:e("div",{children:"Inventory Update"})})]})})}function Re(a){return{html:X(e(_,{location:a,children:e(ve,{})}))}}export{Re as render};
